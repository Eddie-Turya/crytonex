(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3378],{78121:function(e,t,n){"use strict";var i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.FacebookLoginClient=t.SDK_SCRIPT_ELE_ID=void 0;let r=n(1734);t.SDK_SCRIPT_ELE_ID="facebook-jssdk",t.FacebookLoginClient={getFB:()=>window.FB?window.FB:null,getLoginStatus(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getFB();if(!n){e({status:"unknown"});return}n.getLoginStatus(e,t)},getProfile(e,t){var n;null===(n=this.getFB())||void 0===n||n.api("me",t,e)},init(e){var t;null===(t=this.getFB())||void 0===t||t.init(e)},clear(){window.FB=null;let e=document.getElementById(t.SDK_SCRIPT_ELE_ID);e&&e.remove()},isRedirected(e){var t;let n=(0,r.paramsToObject)(window.location.search);return n.state===(null==e?void 0:e.state)&&void 0!==n[null!==(t=null==e?void 0:e.response_type)&&void 0!==t?t:""]},loadSdk(e,n){var i,o,s,a;return i=this,o=void 0,s=void 0,a=function*(){yield(0,r.createScriptEle)(t.SDK_SCRIPT_ELE_ID,"https://connect.facebook.net/".concat(e,"/sdk").concat(n?"/xfbml.customerchat":"",".js"))},new(s||(s=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function r(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof s?i:new s(function(e){e(i)})).then(n,r)}l((a=a.apply(i,o||[])).next())})},redirectToDialog(e,t){var{ignoreSdkError:n}=t,o=i(t,["ignoreSdkError"]);window.location.href="https://www.facebook.com/dialog/oauth".concat((0,r.objectToParams)(Object.assign(Object.assign({},e),o)))},login(e,t){var n,{ignoreSdkError:r}=t,o=i(t,["ignoreSdkError"]);try{null===(n=this.getFB())||void 0===n||n.login(e,o)}catch(e){if(r)return;throw e}},logout(e){this.getLoginStatus(t=>{var n;"connected"===t.status?null===(n=this.getFB())||void 0===n||n.logout(e):e()})}}},19297:function(e,t,n){"use strict";var i=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},r=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Object.defineProperty(t,"__esModule",{value:!0});let o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t}(n(64090)),s=n(78121),a=n(1734);t.default=function(e){var t,n;let{appId:i,language:r="en_US",scope:l="public_profile, email",fields:c="name,email,picture",onSuccess:u,onFail:d,onProfileSuccess:h,className:f,style:g,children:p="Login with Facebook",render:v,autoLoad:y=!1,useRedirect:w=!1,useCustomerChat:b=!1}=e,m=Object.assign(Object.assign({version:"v9.0",xfbml:!1,cookie:!1,localStorage:!0},e.initParams),{appId:i}),_=Object.assign(Object.assign({redirect_uri:location.origin+location.pathname,state:"facebookdirect",response_type:"code"},e.dialogParams),{client_id:i}),E=Object.assign(Object.assign({return_scopes:!1,ignoreSdkError:!1},e.loginOptions),{auth_nonce:"function"==typeof(null===(t=e.loginOptions)||void 0===t?void 0:t.auth_nonce)?e.loginOptions.auth_nonce():null===(n=e.loginOptions)||void 0===n?void 0:n.auth_nonce,scope:l});(0,o.useEffect)(()=>{S()},[]);let S=()=>{var e,t,n,i;return e=this,t=void 0,n=void 0,i=function*(){yield s.FacebookLoginClient.loadSdk(r,b),window.fbAsyncInit=()=>{s.FacebookLoginClient.init(m);let e=s.FacebookLoginClient.isRedirected(_);if(!1===e&&y){O();return}!0===e&&w&&R()}},new(n||(n=Promise))(function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},R=()=>{s.FacebookLoginClient.login(e=>{if(!e.authResponse){d&&d({status:"loginCancelled"});return}u&&u(e.authResponse),h&&s.FacebookLoginClient.getProfile(h,{fields:c})},Object.assign(Object.assign({},E),{scope:l}))},O=()=>{if((0,a.isFacebookApp)()||w){s.FacebookLoginClient.redirectToDialog(_,E);return}if(!window.FB){d&&d({status:"facebookNotLoaded"});return}R()};return v?v({onClick:O,logout:s.FacebookLoginClient.logout}):o.default.createElement("button",{type:"button",onClick:O,className:f,style:g},p)}},70206:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createScriptEle=void 0,t.createScriptEle=(e,t)=>new Promise(n=>{var i;let r=document.getElementsByTagName("script")[0];if(document.getElementById(e)){n(void 0);return}let o=document.createElement("script");if(o.id=e,o.src=t,o.onload=n,r)null===(i=r.parentNode)||void 0===i||i.insertBefore(o,r);else{let e=document.body.childNodes;document.body.insertBefore(o,e.item(e.length-1))}})},1734:function(e,t,n){"use strict";var i=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(70206),t),r(n(70318),t),r(n(67016),t)},70318:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paramsToObject=t.objectToParams=t.isObject=void 0,t.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),t.objectToParams=e=>(0,t.isObject)(e)&&0!==Object.keys(e).length?"?"+Object.keys(e).map(t=>"".concat(t,"=").concat(encodeURIComponent(e[t]))).join("&"):"",t.paramsToObject=e=>(null==e?void 0:e.replace(/^\?/,"").split("&").reduce((e,t)=>{if(!t)return e;let[n,i]=t.split("=");return Object.assign(Object.assign({},e),{[n]:decodeURIComponent(i)})},{}))||{}},67016:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFacebookApp=void 0,t.isFacebookApp=()=>{let e=navigator.userAgent||navigator.vendor||window.opera;return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1||e.indexOf("Instagram")>-1}},54994:function(e,t,n){"use strict";var i,r=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},o=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});let s=(i=n(19297))&&i.__esModule?i:{default:i};o(n(1734),t),o(n(84974),t),o(n(19297),t),o(n(78121),t),t.default=s.default},21354:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},84974:function(e,t,n){"use strict";var i=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},r=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(21354),t),r(n(82690),t),r(n(81294),t)},82690:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},81294:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LoginStatus=void 0,(n=t.LoginStatus||(t.LoginStatus={})).Connected="connected",n.NotAuthorized="not_authorized",n.Unknown="unknown"},38028:function(e,t,n){"use strict";n.r(t),n.d(t,{GoogleLogin:function(){return c},GoogleOAuthProvider:function(){return o},googleLogout:function(){return u},hasGrantedAllScopesGoogle:function(){return f},hasGrantedAnyScopeGoogle:function(){return g},useGoogleLogin:function(){return d},useGoogleOAuth:function(){return s},useGoogleOneTapLogin:function(){return h}});var i=n(64090);let r=(0,i.createContext)(null);function o(e){let{clientId:t,nonce:n,onScriptLoadSuccess:o,onScriptLoadError:s,children:a}=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:r}=e,[o,s]=(0,i.useState)(!1),a=(0,i.useRef)(n);a.current=n;let l=(0,i.useRef)(r);return l.current=r,(0,i.useEffect)(()=>{let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;s(!0),null===(e=a.current)||void 0===e||e.call(a)},e.onerror=()=>{var e;s(!1),null===(e=l.current)||void 0===e||e.call(l)},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]),o}({nonce:n,onScriptLoadSuccess:o,onScriptLoadError:s}),c=(0,i.useMemo)(()=>({clientId:t,scriptLoadedSuccessfully:l}),[t,l]);return i.createElement(r.Provider,{value:c},a)}function s(){let e=(0,i.useContext)(r);if(!e)throw Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function a(e){var t;return null!==(t=null==e?void 0:e.clientId)&&void 0!==t?t:null==e?void 0:e.client_id}let l={large:40,medium:32,small:20};function c(e){let{onSuccess:t,onError:n,useOneTap:r,promptMomentNotification:o,type:c="standard",theme:u="outline",size:d="large",text:h,shape:f,logo_alignment:g,width:p,locale:v,click_listener:y,containerProps:w,...b}=e,m=(0,i.useRef)(null),{clientId:_,scriptLoadedSuccessfully:E}=s(),S=(0,i.useRef)(t);S.current=t;let R=(0,i.useRef)(n);R.current=n;let O=(0,i.useRef)(o);return O.current=o,(0,i.useEffect)(()=>{var e,t,n,i,o,s,l,w,C;if(E)return null===(n=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===n||n.initialize({client_id:_,callback:e=>{var t;if(!(null==e?void 0:e.credential))return null===(t=R.current)||void 0===t?void 0:t.call(R);let{credential:n,select_by:i}=e;S.current({credential:n,clientId:a(e),select_by:i})},...b}),null===(s=null===(o=null===(i=null==window?void 0:window.google)||void 0===i?void 0:i.accounts)||void 0===o?void 0:o.id)||void 0===s||s.renderButton(m.current,{type:c,theme:u,size:d,text:h,shape:f,logo_alignment:g,width:p,locale:v,click_listener:y}),r&&(null===(C=null===(w=null===(l=null==window?void 0:window.google)||void 0===l?void 0:l.accounts)||void 0===w?void 0:w.id)||void 0===C||C.prompt(O.current)),()=>{var e,t,n;r&&(null===(n=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===n||n.cancel())}},[_,E,r,c,u,d,h,f,g,p,v]),i.createElement("div",{...w,ref:m,style:{height:l[d],...null==w?void 0:w.style}})}function u(){var e,t,n;null===(n=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===n||n.disableAutoSelect()}function d(e){let{flow:t="implicit",scope:n="",onSuccess:r,onError:o,onNonOAuthError:a,overrideScope:l,state:c,...u}=e,{clientId:d,scriptLoadedSuccessfully:h}=s(),f=(0,i.useRef)(),g=(0,i.useRef)(r);g.current=r;let p=(0,i.useRef)(o);p.current=o;let v=(0,i.useRef)(a);v.current=a,(0,i.useEffect)(()=>{var e,i;if(!h)return;let r="implicit"===t?"initTokenClient":"initCodeClient",o=null===(i=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===i?void 0:i.oauth2[r]({client_id:d,scope:l?n:"openid profile email ".concat(n),callback:e=>{var t,n;if(e.error)return null===(t=p.current)||void 0===t?void 0:t.call(p,e);null===(n=g.current)||void 0===n||n.call(g,e)},error_callback:e=>{var t;null===(t=v.current)||void 0===t||t.call(v,e)},state:c,...u});f.current=o},[d,h,t,n,c]);let y=(0,i.useCallback)(e=>{var t;return null===(t=f.current)||void 0===t?void 0:t.requestAccessToken(e)},[]),w=(0,i.useCallback)(()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.requestCode()},[]);return"implicit"===t?y:w}function h(e){let{onSuccess:t,onError:n,promptMomentNotification:r,cancel_on_tap_outside:o,prompt_parent_id:l,state_cookie_domain:c,hosted_domain:u,use_fedcm_for_prompt:d=!1,disabled:h,auto_select:f}=e,{clientId:g,scriptLoadedSuccessfully:p}=s(),v=(0,i.useRef)(t);v.current=t;let y=(0,i.useRef)(n);y.current=n;let w=(0,i.useRef)(r);w.current=r,(0,i.useEffect)(()=>{var e,t,n,i,r,s,b,m,_;if(p){if(h){null===(n=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===n||n.cancel();return}return null===(s=null===(r=null===(i=null==window?void 0:window.google)||void 0===i?void 0:i.accounts)||void 0===r?void 0:r.id)||void 0===s||s.initialize({client_id:g,callback:e=>{var t;if(!(null==e?void 0:e.credential))return null===(t=y.current)||void 0===t?void 0:t.call(y);let{credential:n,select_by:i}=e;v.current({credential:n,clientId:a(e),select_by:i})},hosted_domain:u,cancel_on_tap_outside:o,prompt_parent_id:l,state_cookie_domain:c,use_fedcm_for_prompt:d,auto_select:f}),null===(_=null===(m=null===(b=null==window?void 0:window.google)||void 0===b?void 0:b.accounts)||void 0===m?void 0:m.id)||void 0===_||_.prompt(w.current),()=>{var e,t,n;null===(n=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===n||n.cancel()}}},[g,p,o,l,c,u,d,h,f])}function f(e,t){for(var n,i,r,o=arguments.length,s=Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];return null!=window&&!!window.google&&((null===(r=null===(i=null===(n=null==window?void 0:window.google)||void 0===n?void 0:n.accounts)||void 0===i?void 0:i.oauth2)||void 0===r?void 0:r.hasGrantedAllScopes(e,t,...s))||!1)}function g(e,t){for(var n,i,r,o=arguments.length,s=Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];return null!=window&&!!window.google&&((null===(r=null===(i=null===(n=null==window?void 0:window.google)||void 0===n?void 0:n.accounts)||void 0===i?void 0:i.oauth2)||void 0===r?void 0:r.hasGrantedAnyScope(e,t,...s))||!1)}},44244:function(e,t,n){"use strict";var i,r,o=n(88924).Buffer;i=void 0,r=function(){var e={};function t(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw TypeError("expected string");var t,n=unescape(encodeURIComponent(e)),i=new Uint8Array(n.length);for(t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i},e.encodeUTF8=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==o.from?(e.encodeBase64=function(e){return o.from(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(o.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new o(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(new o(e,"base64"),0))}):(e.encodeBase64=function(e){var t,n=[],i=e.length;for(t=0;t<i;t++)n.push(String.fromCharCode(e[t]));return btoa(n.join(""))},e.decodeBase64=function(e){t(e);var n,i=atob(e),r=new Uint8Array(i.length);for(n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return r}),e},e.exports?e.exports=r():(i.nacl||(i.nacl={}),i.nacl.util=r())},54774:function(e,t,n){!function(e){"use strict";var t,i=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n},r=function(){throw Error("no PRNG")},o=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var a=i(),l=i([1]),c=i([56129,1]),u=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,n,i){e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n,e[t+4]=i>>24&255,e[t+5]=i>>16&255,e[t+6]=i>>8&255,e[t+7]=255&i}function v(e,t,n,i,r){var o,s=0;for(o=0;o<r;o++)s|=e[t+o]^n[i+o];return(1&s-1>>>8)-1}function y(e,t,n,i){return v(e,t,n,i,16)}function w(e,t,n,i){return v(e,t,n,i,32)}function b(e,t,n,i){!function(e,t,n,i){for(var r,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,c=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,g=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,p=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,v=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,w=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,m=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,_=o,E=s,S=a,R=l,O=c,C=u,k=d,T=h,A=f,P=g,U=p,j=v,L=y,N=w,x=b,I=m,M=0;M<20;M+=2)O^=(r=_+L|0)<<7|r>>>25,A^=(r=O+_|0)<<9|r>>>23,L^=(r=A+O|0)<<13|r>>>19,_^=(r=L+A|0)<<18|r>>>14,P^=(r=C+E|0)<<7|r>>>25,N^=(r=P+C|0)<<9|r>>>23,E^=(r=N+P|0)<<13|r>>>19,C^=(r=E+N|0)<<18|r>>>14,x^=(r=U+k|0)<<7|r>>>25,S^=(r=x+U|0)<<9|r>>>23,k^=(r=S+x|0)<<13|r>>>19,U^=(r=k+S|0)<<18|r>>>14,R^=(r=I+j|0)<<7|r>>>25,T^=(r=R+I|0)<<9|r>>>23,j^=(r=T+R|0)<<13|r>>>19,I^=(r=j+T|0)<<18|r>>>14,E^=(r=_+R|0)<<7|r>>>25,S^=(r=E+_|0)<<9|r>>>23,R^=(r=S+E|0)<<13|r>>>19,_^=(r=R+S|0)<<18|r>>>14,k^=(r=C+O|0)<<7|r>>>25,T^=(r=k+C|0)<<9|r>>>23,O^=(r=T+k|0)<<13|r>>>19,C^=(r=O+T|0)<<18|r>>>14,j^=(r=U+P|0)<<7|r>>>25,A^=(r=j+U|0)<<9|r>>>23,P^=(r=A+j|0)<<13|r>>>19,U^=(r=P+A|0)<<18|r>>>14,L^=(r=I+x|0)<<7|r>>>25,N^=(r=L+I|0)<<9|r>>>23,x^=(r=N+L|0)<<13|r>>>19,I^=(r=x+N|0)<<18|r>>>14;_=_+o|0,E=E+s|0,S=S+a|0,R=R+l|0,O=O+c|0,C=C+u|0,k=k+d|0,T=T+h|0,A=A+f|0,P=P+g|0,U=U+p|0,j=j+v|0,L=L+y|0,N=N+w|0,x=x+b|0,I=I+m|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=E>>>0&255,e[5]=E>>>8&255,e[6]=E>>>16&255,e[7]=E>>>24&255,e[8]=S>>>0&255,e[9]=S>>>8&255,e[10]=S>>>16&255,e[11]=S>>>24&255,e[12]=R>>>0&255,e[13]=R>>>8&255,e[14]=R>>>16&255,e[15]=R>>>24&255,e[16]=O>>>0&255,e[17]=O>>>8&255,e[18]=O>>>16&255,e[19]=O>>>24&255,e[20]=C>>>0&255,e[21]=C>>>8&255,e[22]=C>>>16&255,e[23]=C>>>24&255,e[24]=k>>>0&255,e[25]=k>>>8&255,e[26]=k>>>16&255,e[27]=k>>>24&255,e[28]=T>>>0&255,e[29]=T>>>8&255,e[30]=T>>>16&255,e[31]=T>>>24&255,e[32]=A>>>0&255,e[33]=A>>>8&255,e[34]=A>>>16&255,e[35]=A>>>24&255,e[36]=P>>>0&255,e[37]=P>>>8&255,e[38]=P>>>16&255,e[39]=P>>>24&255,e[40]=U>>>0&255,e[41]=U>>>8&255,e[42]=U>>>16&255,e[43]=U>>>24&255,e[44]=j>>>0&255,e[45]=j>>>8&255,e[46]=j>>>16&255,e[47]=j>>>24&255,e[48]=L>>>0&255,e[49]=L>>>8&255,e[50]=L>>>16&255,e[51]=L>>>24&255,e[52]=N>>>0&255,e[53]=N>>>8&255,e[54]=N>>>16&255,e[55]=N>>>24&255,e[56]=x>>>0&255,e[57]=x>>>8&255,e[58]=x>>>16&255,e[59]=x>>>24&255,e[60]=I>>>0&255,e[61]=I>>>8&255,e[62]=I>>>16&255,e[63]=I>>>24&255}(e,t,n,i)}function m(e,t,n,i){!function(e,t,n,i){for(var r,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,c=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,u=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,g=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,p=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,v=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,w=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,m=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,_=o,E=s,S=a,R=l,O=c,C=u,k=d,T=h,A=f,P=g,U=p,j=v,L=y,N=w,x=b,I=m,M=0;M<20;M+=2)O^=(r=_+L|0)<<7|r>>>25,A^=(r=O+_|0)<<9|r>>>23,L^=(r=A+O|0)<<13|r>>>19,_^=(r=L+A|0)<<18|r>>>14,P^=(r=C+E|0)<<7|r>>>25,N^=(r=P+C|0)<<9|r>>>23,E^=(r=N+P|0)<<13|r>>>19,C^=(r=E+N|0)<<18|r>>>14,x^=(r=U+k|0)<<7|r>>>25,S^=(r=x+U|0)<<9|r>>>23,k^=(r=S+x|0)<<13|r>>>19,U^=(r=k+S|0)<<18|r>>>14,R^=(r=I+j|0)<<7|r>>>25,T^=(r=R+I|0)<<9|r>>>23,j^=(r=T+R|0)<<13|r>>>19,I^=(r=j+T|0)<<18|r>>>14,E^=(r=_+R|0)<<7|r>>>25,S^=(r=E+_|0)<<9|r>>>23,R^=(r=S+E|0)<<13|r>>>19,_^=(r=R+S|0)<<18|r>>>14,k^=(r=C+O|0)<<7|r>>>25,T^=(r=k+C|0)<<9|r>>>23,O^=(r=T+k|0)<<13|r>>>19,C^=(r=O+T|0)<<18|r>>>14,j^=(r=U+P|0)<<7|r>>>25,A^=(r=j+U|0)<<9|r>>>23,P^=(r=A+j|0)<<13|r>>>19,U^=(r=P+A|0)<<18|r>>>14,L^=(r=I+x|0)<<7|r>>>25,N^=(r=L+I|0)<<9|r>>>23,x^=(r=N+L|0)<<13|r>>>19,I^=(r=x+N|0)<<18|r>>>14;e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=C>>>0&255,e[5]=C>>>8&255,e[6]=C>>>16&255,e[7]=C>>>24&255,e[8]=U>>>0&255,e[9]=U>>>8&255,e[10]=U>>>16&255,e[11]=U>>>24&255,e[12]=I>>>0&255,e[13]=I>>>8&255,e[14]=I>>>16&255,e[15]=I>>>24&255,e[16]=k>>>0&255,e[17]=k>>>8&255,e[18]=k>>>16&255,e[19]=k>>>24&255,e[20]=T>>>0&255,e[21]=T>>>8&255,e[22]=T>>>16&255,e[23]=T>>>24&255,e[24]=A>>>0&255,e[25]=A>>>8&255,e[26]=A>>>16&255,e[27]=A>>>24&255,e[28]=P>>>0&255,e[29]=P>>>8&255,e[30]=P>>>16&255,e[31]=P>>>24&255}(e,t,n,i)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function E(e,t,n,i,r,o,s){var a,l,c=new Uint8Array(16),u=new Uint8Array(64);for(l=0;l<16;l++)c[l]=0;for(l=0;l<8;l++)c[l]=o[l];for(;r>=64;){for(b(u,c,s,_),l=0;l<64;l++)e[t+l]=n[i+l]^u[l];for(l=8,a=1;l<16;l++)a=a+(255&c[l])|0,c[l]=255&a,a>>>=8;r-=64,t+=64,i+=64}if(r>0)for(b(u,c,s,_),l=0;l<r;l++)e[t+l]=n[i+l]^u[l];return 0}function S(e,t,n,i,r){var o,s,a=new Uint8Array(16),l=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=i[s];for(;n>=64;){for(b(l,a,r,_),s=0;s<64;s++)e[t+s]=l[s];for(s=8,o=1;s<16;s++)o=o+(255&a[s])|0,a[s]=255&o,o>>>=8;n-=64,t+=64}if(n>0)for(b(l,a,r,_),s=0;s<n;s++)e[t+s]=l[s];return 0}function R(e,t,n,i,r){var o=new Uint8Array(32);m(o,i,r,_);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=i[a+16];return S(e,t,n,s,o)}function O(e,t,n,i,r,o,s){var a=new Uint8Array(32);m(a,o,s,_);for(var l=new Uint8Array(8),c=0;c<8;c++)l[c]=o[c+16];return E(e,t,n,i,r,l,a)}var C=function(e){var t,n,i,r,o,s,a,l;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,n=255&e[2]|(255&e[3])<<8,this.r[1]=(t>>>13|n<<3)&8191,i=255&e[4]|(255&e[5])<<8,this.r[2]=(n>>>10|i<<6)&7939,r=255&e[6]|(255&e[7])<<8,this.r[3]=(i>>>7|r<<9)&8191,o=255&e[8]|(255&e[9])<<8,this.r[4]=(r>>>4|o<<12)&255,this.r[5]=o>>>1&8190,s=255&e[10]|(255&e[11])<<8,this.r[6]=(o>>>14|s<<2)&8191,a=255&e[12]|(255&e[13])<<8,this.r[7]=(s>>>11|a<<5)&8065,l=255&e[14]|(255&e[15])<<8,this.r[8]=(a>>>8|l<<8)&8191,this.r[9]=l>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function k(e,t,n,i,r,o){var s=new C(o);return s.update(n,i,r),s.finish(e,t),0}function T(e,t,n,i,r,o){var s=new Uint8Array(16);return k(s,0,n,i,r,o),y(e,t,s,0)}function A(e,t,n,i,r){var o;if(n<32)return -1;for(O(e,0,t,0,n,i,r),k(e,16,e,32,n-32,e),o=0;o<16;o++)e[o]=0;return 0}function P(e,t,n,i,r){var o,s=new Uint8Array(32);if(n<32||(R(s,0,32,i,r),0!==T(t,16,t,32,n-32,s)))return -1;for(O(e,0,t,0,n,i,r),o=0;o<32;o++)e[o]=0;return 0}function U(e,t){var n;for(n=0;n<16;n++)e[n]=0|t[n]}function j(e){var t,n,i=1;for(t=0;t<16;t++)i=Math.floor((n=e[t]+i+65535)/65536),e[t]=n-65536*i;e[0]+=i-1+37*(i-1)}function L(e,t,n){for(var i,r=~(n-1),o=0;o<16;o++)i=r&(e[o]^t[o]),e[o]^=i,t[o]^=i}function N(e,t){var n,r,o,s=i(),a=i();for(n=0;n<16;n++)a[n]=t[n];for(j(a),j(a),j(a),r=0;r<2;r++){for(n=1,s[0]=a[0]-65517;n<15;n++)s[n]=a[n]-65535-(s[n-1]>>16&1),s[n-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,L(a,s,1-o)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function x(e,t){var n=new Uint8Array(32),i=new Uint8Array(32);return N(n,e),N(i,t),w(n,0,i,0)}function I(e){var t=new Uint8Array(32);return N(t,e),1&t[0]}function M(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function W(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]+n[i]}function D(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]-n[i]}function K(e,t,n){var i,r,o=0,s=0,a=0,l=0,c=0,u=0,d=0,h=0,f=0,g=0,p=0,v=0,y=0,w=0,b=0,m=0,_=0,E=0,S=0,R=0,O=0,C=0,k=0,T=0,A=0,P=0,U=0,j=0,L=0,N=0,x=0,I=n[0],M=n[1],W=n[2],D=n[3],K=n[4],B=n[5],q=n[6],F=n[7],G=n[8],H=n[9],z=n[10],Y=n[11],J=n[12],V=n[13],Q=n[14],X=n[15];o+=(i=t[0])*I,s+=i*M,a+=i*W,l+=i*D,c+=i*K,u+=i*B,d+=i*q,h+=i*F,f+=i*G,g+=i*H,p+=i*z,v+=i*Y,y+=i*J,w+=i*V,b+=i*Q,m+=i*X,s+=(i=t[1])*I,a+=i*M,l+=i*W,c+=i*D,u+=i*K,d+=i*B,h+=i*q,f+=i*F,g+=i*G,p+=i*H,v+=i*z,y+=i*Y,w+=i*J,b+=i*V,m+=i*Q,_+=i*X,a+=(i=t[2])*I,l+=i*M,c+=i*W,u+=i*D,d+=i*K,h+=i*B,f+=i*q,g+=i*F,p+=i*G,v+=i*H,y+=i*z,w+=i*Y,b+=i*J,m+=i*V,_+=i*Q,E+=i*X,l+=(i=t[3])*I,c+=i*M,u+=i*W,d+=i*D,h+=i*K,f+=i*B,g+=i*q,p+=i*F,v+=i*G,y+=i*H,w+=i*z,b+=i*Y,m+=i*J,_+=i*V,E+=i*Q,S+=i*X,c+=(i=t[4])*I,u+=i*M,d+=i*W,h+=i*D,f+=i*K,g+=i*B,p+=i*q,v+=i*F,y+=i*G,w+=i*H,b+=i*z,m+=i*Y,_+=i*J,E+=i*V,S+=i*Q,R+=i*X,u+=(i=t[5])*I,d+=i*M,h+=i*W,f+=i*D,g+=i*K,p+=i*B,v+=i*q,y+=i*F,w+=i*G,b+=i*H,m+=i*z,_+=i*Y,E+=i*J,S+=i*V,R+=i*Q,O+=i*X,d+=(i=t[6])*I,h+=i*M,f+=i*W,g+=i*D,p+=i*K,v+=i*B,y+=i*q,w+=i*F,b+=i*G,m+=i*H,_+=i*z,E+=i*Y,S+=i*J,R+=i*V,O+=i*Q,C+=i*X,h+=(i=t[7])*I,f+=i*M,g+=i*W,p+=i*D,v+=i*K,y+=i*B,w+=i*q,b+=i*F,m+=i*G,_+=i*H,E+=i*z,S+=i*Y,R+=i*J,O+=i*V,C+=i*Q,k+=i*X,f+=(i=t[8])*I,g+=i*M,p+=i*W,v+=i*D,y+=i*K,w+=i*B,b+=i*q,m+=i*F,_+=i*G,E+=i*H,S+=i*z,R+=i*Y,O+=i*J,C+=i*V,k+=i*Q,T+=i*X,g+=(i=t[9])*I,p+=i*M,v+=i*W,y+=i*D,w+=i*K,b+=i*B,m+=i*q,_+=i*F,E+=i*G,S+=i*H,R+=i*z,O+=i*Y,C+=i*J,k+=i*V,T+=i*Q,A+=i*X,p+=(i=t[10])*I,v+=i*M,y+=i*W,w+=i*D,b+=i*K,m+=i*B,_+=i*q,E+=i*F,S+=i*G,R+=i*H,O+=i*z,C+=i*Y,k+=i*J,T+=i*V,A+=i*Q,P+=i*X,v+=(i=t[11])*I,y+=i*M,w+=i*W,b+=i*D,m+=i*K,_+=i*B,E+=i*q,S+=i*F,R+=i*G,O+=i*H,C+=i*z,k+=i*Y,T+=i*J,A+=i*V,P+=i*Q,U+=i*X,y+=(i=t[12])*I,w+=i*M,b+=i*W,m+=i*D,_+=i*K,E+=i*B,S+=i*q,R+=i*F,O+=i*G,C+=i*H,k+=i*z,T+=i*Y,A+=i*J,P+=i*V,U+=i*Q,j+=i*X,w+=(i=t[13])*I,b+=i*M,m+=i*W,_+=i*D,E+=i*K,S+=i*B,R+=i*q,O+=i*F,C+=i*G,k+=i*H,T+=i*z,A+=i*Y,P+=i*J,U+=i*V,j+=i*Q,L+=i*X,b+=(i=t[14])*I,m+=i*M,_+=i*W,E+=i*D,S+=i*K,R+=i*B,O+=i*q,C+=i*F,k+=i*G,T+=i*H,A+=i*z,P+=i*Y,U+=i*J,j+=i*V,L+=i*Q,N+=i*X,m+=(i=t[15])*I,_+=i*M,E+=i*W,S+=i*D,R+=i*K,O+=i*B,C+=i*q,k+=i*F,T+=i*G,A+=i*H,P+=i*z,U+=i*Y,j+=i*J,L+=i*V,N+=i*Q,x+=i*X,o+=38*_,s+=38*E,a+=38*S,l+=38*R,c+=38*O,u+=38*C,d+=38*k,h+=38*T,f+=38*A,g+=38*P,p+=38*U,v+=38*j,y+=38*L,w+=38*N,b+=38*x,r=Math.floor((i=o+(r=1)+65535)/65536),o=i-65536*r,r=Math.floor((i=s+r+65535)/65536),s=i-65536*r,r=Math.floor((i=a+r+65535)/65536),a=i-65536*r,r=Math.floor((i=l+r+65535)/65536),l=i-65536*r,r=Math.floor((i=c+r+65535)/65536),c=i-65536*r,r=Math.floor((i=u+r+65535)/65536),u=i-65536*r,r=Math.floor((i=d+r+65535)/65536),d=i-65536*r,r=Math.floor((i=h+r+65535)/65536),h=i-65536*r,r=Math.floor((i=f+r+65535)/65536),f=i-65536*r,r=Math.floor((i=g+r+65535)/65536),g=i-65536*r,r=Math.floor((i=p+r+65535)/65536),p=i-65536*r,r=Math.floor((i=v+r+65535)/65536),v=i-65536*r,r=Math.floor((i=y+r+65535)/65536),y=i-65536*r,r=Math.floor((i=w+r+65535)/65536),w=i-65536*r,r=Math.floor((i=b+r+65535)/65536),b=i-65536*r,r=Math.floor((i=m+r+65535)/65536),m=i-65536*r,o+=r-1+37*(r-1),r=Math.floor((i=o+(r=1)+65535)/65536),o=i-65536*r,r=Math.floor((i=s+r+65535)/65536),s=i-65536*r,r=Math.floor((i=a+r+65535)/65536),a=i-65536*r,r=Math.floor((i=l+r+65535)/65536),l=i-65536*r,r=Math.floor((i=c+r+65535)/65536),c=i-65536*r,r=Math.floor((i=u+r+65535)/65536),u=i-65536*r,r=Math.floor((i=d+r+65535)/65536),d=i-65536*r,r=Math.floor((i=h+r+65535)/65536),h=i-65536*r,r=Math.floor((i=f+r+65535)/65536),f=i-65536*r,r=Math.floor((i=g+r+65535)/65536),g=i-65536*r,r=Math.floor((i=p+r+65535)/65536),p=i-65536*r,r=Math.floor((i=v+r+65535)/65536),v=i-65536*r,r=Math.floor((i=y+r+65535)/65536),y=i-65536*r,r=Math.floor((i=w+r+65535)/65536),w=i-65536*r,r=Math.floor((i=b+r+65535)/65536),b=i-65536*r,r=Math.floor((i=m+r+65535)/65536),m=i-65536*r,o+=r-1+37*(r-1),e[0]=o,e[1]=s,e[2]=a,e[3]=l,e[4]=c,e[5]=u,e[6]=d,e[7]=h,e[8]=f,e[9]=g,e[10]=p,e[11]=v,e[12]=y,e[13]=w,e[14]=b,e[15]=m}function B(e,t){K(e,t,t)}function q(e,t){var n,r=i();for(n=0;n<16;n++)r[n]=t[n];for(n=253;n>=0;n--)B(r,r),2!==n&&4!==n&&K(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}function F(e,t){var n,r=i();for(n=0;n<16;n++)r[n]=t[n];for(n=250;n>=0;n--)B(r,r),1!==n&&K(r,r,t);for(n=0;n<16;n++)e[n]=r[n]}function G(e,t,n){var r,o,s=new Uint8Array(32),a=new Float64Array(80),l=i(),u=i(),d=i(),h=i(),f=i(),g=i();for(o=0;o<31;o++)s[o]=t[o];for(s[31]=127&t[31]|64,s[0]&=248,M(a,n),o=0;o<16;o++)u[o]=a[o],h[o]=l[o]=d[o]=0;for(o=254,l[0]=h[0]=1;o>=0;--o)L(l,u,r=s[o>>>3]>>>(7&o)&1),L(d,h,r),W(f,l,d),D(l,l,d),W(d,u,h),D(u,u,h),B(h,f),B(g,l),K(l,d,l),K(d,u,f),W(f,l,d),D(l,l,d),B(u,l),D(d,h,g),K(l,d,c),W(l,l,h),K(d,d,l),K(l,h,g),K(h,u,a),B(u,f),L(l,u,r),L(d,h,r);for(o=0;o<16;o++)a[o+16]=l[o],a[o+32]=d[o],a[o+48]=u[o],a[o+64]=h[o];var p=a.subarray(32),v=a.subarray(16);return q(p,p),K(v,v,p),N(e,v),0}function H(e,t){return G(e,t,s)}function z(e,t){return r(t,32),H(e,t)}function Y(e,t,n){var i=new Uint8Array(32);return G(i,n,t),m(e,o,i,_)}C.prototype.blocks=function(e,t,n){for(var i,r,o,s,a,l,c,u,d,h,f,g,p,v,y,w,b,m,_,E=this.fin?0:2048,S=this.h[0],R=this.h[1],O=this.h[2],C=this.h[3],k=this.h[4],T=this.h[5],A=this.h[6],P=this.h[7],U=this.h[8],j=this.h[9],L=this.r[0],N=this.r[1],x=this.r[2],I=this.r[3],M=this.r[4],W=this.r[5],D=this.r[6],K=this.r[7],B=this.r[8],q=this.r[9];n>=16;)S+=8191&(i=255&e[t+0]|(255&e[t+1])<<8),R+=(i>>>13|(r=255&e[t+2]|(255&e[t+3])<<8)<<3)&8191,O+=(r>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6)&8191,C+=(o>>>7|(s=255&e[t+6]|(255&e[t+7])<<8)<<9)&8191,k+=(s>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12)&8191,T+=a>>>1&8191,A+=(a>>>14|(l=255&e[t+10]|(255&e[t+11])<<8)<<2)&8191,P+=(l>>>11|(c=255&e[t+12]|(255&e[t+13])<<8)<<5)&8191,U+=(c>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8)&8191,j+=u>>>5|E,d=(h=(d=0)+S*L+5*q*R+5*B*O+5*K*C+5*D*k)>>>13,h&=8191,h+=5*W*T+5*M*A+5*I*P+5*x*U+5*N*j,d+=h>>>13,h&=8191,d=(f=d+S*N+R*L+5*q*O+5*B*C+5*K*k)>>>13,f&=8191,f+=5*D*T+5*W*A+5*M*P+5*I*U+5*x*j,d+=f>>>13,f&=8191,d=(g=d+S*x+R*N+O*L+5*q*C+5*B*k)>>>13,g&=8191,g+=5*K*T+5*D*A+5*W*P+5*M*U+5*I*j,d+=g>>>13,g&=8191,d=(p=d+S*I+R*x+O*N+C*L+5*q*k)>>>13,p&=8191,p+=5*B*T+5*K*A+5*D*P+5*W*U+5*M*j,d+=p>>>13,p&=8191,d=(v=d+S*M+R*I+O*x+C*N+k*L)>>>13,v&=8191,v+=5*q*T+5*B*A+5*K*P+5*D*U+5*W*j,d+=v>>>13,v&=8191,d=(y=d+S*W+R*M+O*I+C*x+k*N)>>>13,y&=8191,y+=T*L+5*q*A+5*B*P+5*K*U+5*D*j,d+=y>>>13,y&=8191,d=(w=d+S*D+R*W+O*M+C*I+k*x)>>>13,w&=8191,w+=T*N+A*L+5*q*P+5*B*U+5*K*j,d+=w>>>13,w&=8191,d=(b=d+S*K+R*D+O*W+C*M+k*I)>>>13,b&=8191,b+=T*x+A*N+P*L+5*q*U+5*B*j,d+=b>>>13,b&=8191,d=(m=d+S*B+R*K+O*D+C*W+k*M)>>>13,m&=8191,m+=T*I+A*x+P*N+U*L+5*q*j,d+=m>>>13,m&=8191,d=(_=d+S*q+R*B+O*K+C*D+k*W)>>>13,_&=8191,_+=T*M+A*I+P*x+U*N+j*L,d+=_>>>13,_&=8191,h=8191&(d=(d=(d<<2)+d|0)+h|0),d>>>=13,f+=d,S=h,R=f,O=g,C=p,k=v,T=y,A=w,P=b,U=m,j=_,t+=16,n-=16;this.h[0]=S,this.h[1]=R,this.h[2]=O,this.h[3]=C,this.h[4]=k,this.h[5]=T,this.h[6]=A,this.h[7]=P,this.h[8]=U,this.h[9]=j},C.prototype.finish=function(e,t){var n,i,r,o,s=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=n,n=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,s[0]=this.h[0]+5,n=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this.h[o]+n,n=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,i=(1^n)-1,o=0;o<10;o++)s[o]&=i;for(o=0,i=~i;o<10;o++)this.h[o]=this.h[o]&i|s[o];for(o=1,this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,r=this.h[0]+this.pad[0],this.h[0]=65535&r;o<8;o++)r=(this.h[o]+this.pad[o]|0)+(r>>>16)|0,this.h[o]=65535&r;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},C.prototype.update=function(e,t,n){var i,r;if(this.leftover){for((r=16-this.leftover)>n&&(r=n),i=0;i<r;i++)this.buffer[this.leftover+i]=e[t+i];if(n-=r,t+=r,this.leftover+=r,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(r=n-n%16,this.blocks(e,t,r),t+=r,n-=r),n){for(i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=n}};var J=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function V(e,t,n,i){for(var r,o,s,a,l,c,u,d,h,f,g,p,v,y,w,b,m,_,E,S,R,O,C,k,T,A,P=new Int32Array(16),U=new Int32Array(16),j=e[0],L=e[1],N=e[2],x=e[3],I=e[4],M=e[5],W=e[6],D=e[7],K=t[0],B=t[1],q=t[2],F=t[3],G=t[4],H=t[5],z=t[6],Y=t[7],V=0;i>=128;){for(E=0;E<16;E++)S=8*E+V,P[E]=n[S+0]<<24|n[S+1]<<16|n[S+2]<<8|n[S+3],U[E]=n[S+4]<<24|n[S+5]<<16|n[S+6]<<8|n[S+7];for(E=0;E<80;E++)if(r=j,o=L,s=N,a=x,l=I,c=M,u=W,d=D,h=K,f=B,g=q,p=F,v=G,y=H,w=z,b=Y,R=D,C=65535&(O=Y),k=O>>>16,T=65535&R,A=R>>>16,R=(I>>>14|G<<18)^(I>>>18|G<<14)^(G>>>9|I<<23),C+=65535&(O=(G>>>14|I<<18)^(G>>>18|I<<14)^(I>>>9|G<<23)),k+=O>>>16,T+=65535&R,A+=R>>>16,R=I&M^~I&W,C+=65535&(O=G&H^~G&z),k+=O>>>16,T+=65535&R,A+=R>>>16,R=J[2*E],C+=65535&(O=J[2*E+1]),k+=O>>>16,T+=65535&R,A+=R>>>16,R=P[E%16],C+=65535&(O=U[E%16]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,m=65535&T|A<<16,_=65535&C|k<<16,R=m,C=65535&(O=_),k=O>>>16,T=65535&R,A=R>>>16,R=(j>>>28|K<<4)^(K>>>2|j<<30)^(K>>>7|j<<25),C+=65535&(O=(K>>>28|j<<4)^(j>>>2|K<<30)^(j>>>7|K<<25)),k+=O>>>16,T+=65535&R,A+=R>>>16,R=j&L^j&N^L&N,C+=65535&(O=K&B^K&q^B&q),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,d=65535&T|A<<16,b=65535&C|k<<16,R=a,C=65535&(O=p),k=O>>>16,T=65535&R,A=R>>>16,R=m,C+=65535&(O=_),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,a=65535&T|A<<16,p=65535&C|k<<16,L=r,N=o,x=s,I=a,M=l,W=c,D=u,j=d,B=h,q=f,F=g,G=p,H=v,z=y,Y=w,K=b,E%16==15)for(S=0;S<16;S++)R=P[S],C=65535&(O=U[S]),k=O>>>16,T=65535&R,A=R>>>16,R=P[(S+9)%16],C+=65535&(O=U[(S+9)%16]),k+=O>>>16,T+=65535&R,A+=R>>>16,R=((m=P[(S+1)%16])>>>1|(_=U[(S+1)%16])<<31)^(m>>>8|_<<24)^m>>>7,C+=65535&(O=(_>>>1|m<<31)^(_>>>8|m<<24)^(_>>>7|m<<25)),k+=O>>>16,T+=65535&R,A+=R>>>16,R=((m=P[(S+14)%16])>>>19|(_=U[(S+14)%16])<<13)^(_>>>29|m<<3)^m>>>6,C+=65535&(O=(_>>>19|m<<13)^(m>>>29|_<<3)^(_>>>6|m<<26)),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,P[S]=65535&T|A<<16,U[S]=65535&C|k<<16;R=j,C=65535&(O=K),k=O>>>16,T=65535&R,A=R>>>16,R=e[0],C+=65535&(O=t[0]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[0]=j=65535&T|A<<16,t[0]=K=65535&C|k<<16,R=L,C=65535&(O=B),k=O>>>16,T=65535&R,A=R>>>16,R=e[1],C+=65535&(O=t[1]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[1]=L=65535&T|A<<16,t[1]=B=65535&C|k<<16,R=N,C=65535&(O=q),k=O>>>16,T=65535&R,A=R>>>16,R=e[2],C+=65535&(O=t[2]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[2]=N=65535&T|A<<16,t[2]=q=65535&C|k<<16,R=x,C=65535&(O=F),k=O>>>16,T=65535&R,A=R>>>16,R=e[3],C+=65535&(O=t[3]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[3]=x=65535&T|A<<16,t[3]=F=65535&C|k<<16,R=I,C=65535&(O=G),k=O>>>16,T=65535&R,A=R>>>16,R=e[4],C+=65535&(O=t[4]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[4]=I=65535&T|A<<16,t[4]=G=65535&C|k<<16,R=M,C=65535&(O=H),k=O>>>16,T=65535&R,A=R>>>16,R=e[5],C+=65535&(O=t[5]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[5]=M=65535&T|A<<16,t[5]=H=65535&C|k<<16,R=W,C=65535&(O=z),k=O>>>16,T=65535&R,A=R>>>16,R=e[6],C+=65535&(O=t[6]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[6]=W=65535&T|A<<16,t[6]=z=65535&C|k<<16,R=D,C=65535&(O=Y),k=O>>>16,T=65535&R,A=R>>>16,R=e[7],C+=65535&(O=t[7]),k+=O>>>16,T+=65535&R,A+=R>>>16,k+=C>>>16,T+=k>>>16,A+=T>>>16,e[7]=D=65535&T|A<<16,t[7]=Y=65535&C|k<<16,V+=128,i-=128}return i}function Q(e,t,n){var i,r=new Int32Array(8),o=new Int32Array(8),s=new Uint8Array(256),a=n;for(r[0]=1779033703,r[1]=3144134277,r[2]=1013904242,r[3]=2773480762,r[4]=1359893119,r[5]=2600822924,r[6]=528734635,r[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,V(r,o,t,n),n%=128,i=0;i<n;i++)s[i]=t[a-n+i];for(s[n]=128,s[(n=256-128*(n<112?1:0))-9]=0,p(s,n-8,a/536870912|0,a<<3),V(r,o,s,n),i=0;i<8;i++)p(e,8*i,r[i],o[i]);return 0}function X(e,t){var n=i(),r=i(),o=i(),s=i(),a=i(),l=i(),c=i(),u=i(),h=i();D(n,e[1],e[0]),D(h,t[1],t[0]),K(n,n,h),W(r,e[0],e[1]),W(h,t[0],t[1]),K(r,r,h),K(o,e[3],t[3]),K(o,o,d),K(s,e[2],t[2]),W(s,s,s),D(a,r,n),D(l,s,o),W(c,s,o),W(u,r,n),K(e[0],a,l),K(e[1],u,c),K(e[2],c,l),K(e[3],a,u)}function Z(e,t,n){var i;for(i=0;i<4;i++)L(e[i],t[i],n)}function $(e,t){var n=i(),r=i(),o=i();q(o,t[2]),K(n,t[0],o),K(r,t[1],o),N(e,r),e[31]^=I(n)<<7}function ee(e,t,n){var i,r;for(U(e[0],a),U(e[1],l),U(e[2],l),U(e[3],a),r=255;r>=0;--r)Z(e,t,i=n[r/8|0]>>(7&r)&1),X(t,e),X(e,e),Z(e,t,i)}function et(e,t){var n=[i(),i(),i(),i()];U(n[0],h),U(n[1],f),U(n[2],l),K(n[3],h,f),ee(e,n,t)}function en(e,t,n){var o,s=new Uint8Array(64),a=[i(),i(),i(),i()];for(n||r(t,32),Q(s,t,32),s[0]&=248,s[31]&=127,s[31]|=64,et(a,s),$(e,a),o=0;o<32;o++)t[o+32]=e[o];return 0}var ei=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function er(e,t){var n,i,r,o;for(i=63;i>=32;--i){for(n=0,r=i-32,o=i-12;r<o;++r)t[r]+=n-16*t[i]*ei[r-(i-32)],n=Math.floor((t[r]+128)/256),t[r]-=256*n;t[r]+=n,t[i]=0}for(r=0,n=0;r<32;r++)t[r]+=n-(t[31]>>4)*ei[r],n=t[r]>>8,t[r]&=255;for(r=0;r<32;r++)t[r]-=n*ei[r];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function eo(e){var t,n=new Float64Array(64);for(t=0;t<64;t++)n[t]=e[t];for(t=0;t<64;t++)e[t]=0;er(e,n)}function es(e,t,n,r){var o,s,a=new Uint8Array(64),l=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),d=[i(),i(),i(),i()];for(Q(a,r,32),a[0]&=248,a[31]&=127,a[31]|=64,o=0;o<n;o++)e[64+o]=t[o];for(o=0;o<32;o++)e[32+o]=a[32+o];for(Q(c,e.subarray(32),n+32),eo(c),et(d,c),$(e,d),o=32;o<64;o++)e[o]=r[o];for(Q(l,e,n+64),eo(l),o=0;o<64;o++)u[o]=0;for(o=0;o<32;o++)u[o]=c[o];for(o=0;o<32;o++)for(s=0;s<32;s++)u[o+s]+=l[o]*a[s];return er(e.subarray(32),u),n+64}function ea(e,t,n,r){var o,s,c,d,h,f,p,v,y=new Uint8Array(32),b=new Uint8Array(64),m=[i(),i(),i(),i()],_=[i(),i(),i(),i()];if(n<64||(o=i(),s=i(),c=i(),d=i(),h=i(),f=i(),p=i(),(U(_[2],l),M(_[1],r),B(c,_[1]),K(d,c,u),D(c,c,_[2]),W(d,_[2],d),B(h,d),B(f,h),K(p,f,h),K(o,p,c),K(o,o,d),F(o,o),K(o,o,c),K(o,o,d),K(o,o,d),K(_[0],o,d),B(s,_[0]),K(s,s,d),x(s,c)&&K(_[0],_[0],g),B(s,_[0]),K(s,s,d),x(s,c))?-1:(I(_[0])===r[31]>>7&&D(_[0],a,_[0]),K(_[3],_[0],_[1]),0)))return -1;for(v=0;v<n;v++)e[v]=t[v];for(v=0;v<32;v++)e[v+32]=r[v];if(Q(b,e,n),eo(b),ee(m,_,b),et(_,t.subarray(32)),X(m,_),$(y,m),n-=64,w(t,0,y,0)){for(v=0;v<n;v++)e[v]=0;return -1}for(v=0;v<n;v++)e[v]=t[v+64];return n}function el(e,t){if(32!==e.length)throw Error("bad key size");if(24!==t.length)throw Error("bad nonce size")}function ec(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw TypeError("unexpected type, use Uint8Array")}function eu(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:m,crypto_stream_xor:O,crypto_stream:R,crypto_stream_salsa20_xor:E,crypto_stream_salsa20:S,crypto_onetimeauth:k,crypto_onetimeauth_verify:T,crypto_verify_16:y,crypto_verify_32:w,crypto_secretbox:A,crypto_secretbox_open:P,crypto_scalarmult:G,crypto_scalarmult_base:H,crypto_box_beforenm:Y,crypto_box_afternm:A,crypto_box:function(e,t,n,i,r,o){var s=new Uint8Array(32);return Y(s,r,o),A(e,t,n,i,s)},crypto_box_open:function(e,t,n,i,r,o){var s=new Uint8Array(32);return Y(s,r,o),P(e,t,n,i,s)},crypto_box_keypair:z,crypto_hash:Q,crypto_sign:es,crypto_sign_keypair:en,crypto_sign_open:ea,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:i,D:u,L:ei,pack25519:N,unpack25519:M,M:K,A:W,S:B,Z:D,pow2523:F,add:X,set25519:U,modL:er,scalarmult:ee,scalarbase:et},e.randomBytes=function(e){var t=new Uint8Array(e);return r(t,e),t},e.secretbox=function(e,t,n){ec(e,t,n),el(n,t);for(var i=new Uint8Array(32+e.length),r=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+32]=e[o];return A(r,i,i.length,t,n),r.subarray(16)},e.secretbox.open=function(e,t,n){ec(e,t,n),el(n,t);for(var i=new Uint8Array(16+e.length),r=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+16]=e[o];return i.length<32||0!==P(r,i,i.length,t,n)?null:r.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(ec(e,t),32!==e.length)throw Error("bad n size");if(32!==t.length)throw Error("bad p size");var n=new Uint8Array(32);return G(n,e,t),n},e.scalarMult.base=function(e){if(ec(e),32!==e.length)throw Error("bad n size");var t=new Uint8Array(32);return H(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,n,i,r){var o=e.box.before(i,r);return e.secretbox(t,n,o)},e.box.before=function(e,t){ec(e,t),function(e,t){if(32!==e.length)throw Error("bad public key size");if(32!==t.length)throw Error("bad secret key size")}(e,t);var n=new Uint8Array(32);return Y(n,e,t),n},e.box.after=e.secretbox,e.box.open=function(t,n,i,r){var o=e.box.before(i,r);return e.secretbox.open(t,n,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return z(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(ec(e),32!==e.length)throw Error("bad secret key size");var t=new Uint8Array(32);return H(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(ec(e,t),64!==t.length)throw Error("bad secret key size");var n=new Uint8Array(64+e.length);return es(n,e,e.length,t),n},e.sign.open=function(e,t){if(ec(e,t),32!==t.length)throw Error("bad public key size");var n=new Uint8Array(e.length),i=ea(n,e,e.length,t);if(i<0)return null;for(var r=new Uint8Array(i),o=0;o<r.length;o++)r[o]=n[o];return r},e.sign.detached=function(t,n){for(var i=e.sign(t,n),r=new Uint8Array(64),o=0;o<r.length;o++)r[o]=i[o];return r},e.sign.detached.verify=function(e,t,n){if(ec(e,t,n),64!==t.length)throw Error("bad signature size");if(32!==n.length)throw Error("bad public key size");var i,r=new Uint8Array(64+e.length),o=new Uint8Array(64+e.length);for(i=0;i<64;i++)r[i]=t[i];for(i=0;i<e.length;i++)r[i+64]=e[i];return ea(o,r,r.length,n)>=0},e.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return en(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(ec(e),64!==e.length)throw Error("bad secret key size");for(var t=new Uint8Array(32),n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(ec(e),32!==e.length)throw Error("bad seed size");for(var t=new Uint8Array(32),n=new Uint8Array(64),i=0;i<32;i++)n[i]=e[i];return en(t,n,!0),{publicKey:t,secretKey:n}},e.sign.publicKeyLength=32,e.sign.secretKeyLength=64,e.sign.seedLength=32,e.sign.signatureLength=64,e.hash=function(e){ec(e);var t=new Uint8Array(64);return Q(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return ec(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===v(e,0,t,0,e.length)},e.setPRNG=function(e){r=e},(t="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&t.getRandomValues?e.setPRNG(function(e,n){var i,r=new Uint8Array(n);for(i=0;i<n;i+=65536)t.getRandomValues(r.subarray(i,i+Math.min(n-i,65536)));for(i=0;i<n;i++)e[i]=r[i];eu(r)}):(t=n(55024))&&t.randomBytes&&e.setPRNG(function(e,n){var i,r=t.randomBytes(n);for(i=0;i<n;i++)e[i]=r[i];eu(r)})}(e.exports?e.exports:self.nacl=self.nacl||{})},73667:function(e,t,n){"use strict";n.r(t),n.d(t,{useQuery:function(){return o}});var i=n(86968),r=n(99473);function o(e,t){return(0,r.r)(e,i.z,t)}},78993:function(e,t,n){"use strict";n.d(t,{PS:function(){return ef}});var i,r,o,s,a,l,c,u,d,h,f,g,p=n(44244),v=n(54774);n(49079),(i=c||(c={}))[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",i[i.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",i[i.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",i[i.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",i[i.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",(r=u||(u={}))[r.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",r[r.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",(o=d||(d={}))[o.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",o[o.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",o[o.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",o[o.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",o[o.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",(s=h||(h={}))[s.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",s[s.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",s[s.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",s[s.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",s[s.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",(a=f||(f={}))[a.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",a[a.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",a[a.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",a[a.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED",(l=g||(g={})).MAINNET="-239",l.TESTNET="-3";let y={encode:function(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e instanceof Uint8Array?t=e:("string"!=typeof e&&(e=JSON.stringify(e)),t=p.decodeUTF8(e)),function(e,t){let n=p.encodeBase64(e);return t?encodeURIComponent(n):n}(t,n)},decode:function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(t=e,n&&(t=decodeURIComponent(t)),p.decodeBase64(t));return{toString:()=>p.encodeUTF8(i),toObject(){try{return JSON.parse(p.encodeUTF8(i))}catch(e){return null}},toUint8Array:()=>i}}};function w(e){let t="";return e.forEach(e=>{t+=("0"+(255&e).toString(16)).slice(-2)}),t}function b(e){if(e.length%2!=0)throw Error("Cannot convert ".concat(e," to bytesArray"));let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t}class m{createKeypair(){return v.box.keyPair()}createKeypairFromString(e){return{publicKey:b(e.publicKey),secretKey:b(e.secretKey)}}createNonce(){return v.randomBytes(this.nonceLength)}encrypt(e,t){let n=new TextEncoder().encode(e),i=this.createNonce(),r=v.box(n,i,t,this.keyPair.secretKey);return function(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(i,r)}decrypt(e,t){let[n,i]=function(e,t){if(t>=e.length)throw Error("Index is out of buffer");return[e.slice(0,t),e.slice(t)]}(e,this.nonceLength),r=v.box.open(i,n,t,this.keyPair.secretKey);if(!r)throw Error("Decryption error: \n message: ".concat(e.toString()," \n sender pubkey: ").concat(t.toString()," \n keypair pubkey: ").concat(this.keyPair.publicKey.toString()," \n keypair secretkey: ").concat(this.keyPair.secretKey.toString()));return new TextDecoder().decode(r)}stringifyKeypair(){return{publicKey:w(this.keyPair.publicKey),secretKey:w(this.keyPair.secretKey)}}constructor(e){this.nonceLength=24,this.keyPair=e?this.createKeypairFromString(e):this.createKeypair(),this.sessionId=w(this.keyPair.publicKey)}}var _=n(49079);function E(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}class S extends Error{get info(){return""}constructor(e,t){super(e,t),this.message="".concat(S.prefix," ").concat(this.constructor.name).concat(this.info?": "+this.info:"").concat(e?"\n"+e:""),Object.setPrototypeOf(this,S.prototype)}}S.prefix="[TON_CONNECT_SDK_ERROR]";class R extends S{get info(){return"Passed DappMetadata is in incorrect format."}constructor(...e){super(...e),Object.setPrototypeOf(this,R.prototype)}}class O extends S{get info(){return"Passed `tonconnect-manifest.json` contains errors. Check format of your manifest. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,O.prototype)}}class C extends S{get info(){return"Manifest not found. Make sure you added `tonconnect-manifest.json` to the root of your app or passed correct manifestUrl. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,C.prototype)}}class k extends S{get info(){return"Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection."}constructor(...e){super(...e),Object.setPrototypeOf(this,k.prototype)}}class T extends S{get info(){return"Send transaction or other protocol methods called while wallet is not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,T.prototype)}}class A extends S{get info(){return"User rejects the action in the wallet."}constructor(...e){super(...e),Object.setPrototypeOf(this,A.prototype)}}class P extends S{get info(){return"Request to the wallet contains errors."}constructor(...e){super(...e),Object.setPrototypeOf(this,P.prototype)}}class U extends S{get info(){return"App tries to send rpc request to the injected wallet while not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,U.prototype)}}class j extends S{get info(){return"There is an attempt to connect to the injected wallet while it is not exists in the webpage."}constructor(...e){super(...e),Object.setPrototypeOf(this,j.prototype)}}class L extends S{get info(){return"An error occurred while fetching the wallets list."}constructor(...e){super(...e),Object.setPrototypeOf(this,L.prototype)}}class N extends S{constructor(...e){super(...e),Object.setPrototypeOf(this,N.prototype)}}let x={[c.UNKNOWN_ERROR]:N,[c.USER_REJECTS_ERROR]:A,[c.BAD_REQUEST_ERROR]:P,[c.UNKNOWN_APP_ERROR]:U,[c.MANIFEST_NOT_FOUND_ERROR]:C,[c.MANIFEST_CONTENT_ERROR]:O};class I{parseError(e){let t=N;return e.code in x&&(t=x[e.code]||N),new t(e.message)}}let M=new I;class W{isError(e){return"error"in e}}let D={[d.UNKNOWN_ERROR]:N,[d.USER_REJECTS_ERROR]:A,[d.BAD_REQUEST_ERROR]:P,[d.UNKNOWN_APP_ERROR]:U};class K extends W{convertToRpcRequest(e){return{method:"sendTransaction",params:[JSON.stringify(e)]}}parseAndThrowError(e){let t=N;throw e.error.code in D&&(t=D[e.error.code]||N),new t(e.error.message)}convertFromRpcResponse(e){return{boc:e.result}}}let B=new K;class q{storeLastEventId(e){return E(this,void 0,void 0,function*(){return this.storage.setItem(this.storeKey,e)})}removeLastEventId(){return E(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getLastEventId(){return E(this,void 0,void 0,function*(){return(yield this.storage.getItem(this.storeKey))||null})}constructor(e,t){this.storage=e,this.storeKey="ton-connect-storage_http-bridge-gateway::"+t}}function F(e,t){return("/"===e.slice(-1)?e.slice(0,-1):e)+"/"+t}function G(e,t){return E(this,void 0,void 0,function*(){return new Promise((n,i)=>{var r,o;if(null===(r=null==t?void 0:t.signal)||void 0===r?void 0:r.aborted){i(new S("Delay aborted"));return}let s=setTimeout(()=>n(),e);null===(o=null==t?void 0:t.signal)||void 0===o||o.addEventListener("abort",()=>{clearTimeout(s),i(new S("Delay aborted"))})})})}function H(e){let t=new AbortController;return(null==e?void 0:e.aborted)?t.abort():null==e||e.addEventListener("abort",()=>t.abort(),{once:!0}),t}function z(e,t){var n,i;return E(this,void 0,void 0,function*(){let r;let o=null!==(n=null==t?void 0:t.attempts)&&void 0!==n?n:10,s=null!==(i=null==t?void 0:t.delayMs)&&void 0!==i?i:200,a=H(null==t?void 0:t.signal);if("function"!=typeof e)throw new S("Expected a function, got ".concat(typeof e));let l=0;for(;l<o;){if(a.signal.aborted)throw new S("Aborted after attempts ".concat(l));try{return yield e({signal:a.signal})}catch(e){r=e,++l<o&&(yield G(s))}}throw r})}function Y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n]}function J(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n]}class V{get isReady(){let e=this.eventSource.current();return(null==e?void 0:e.readyState)===EventSource.OPEN}get isClosed(){let e=this.eventSource.current();return(null==e?void 0:e.readyState)!==EventSource.OPEN}get isConnecting(){let e=this.eventSource.current();return(null==e?void 0:e.readyState)===EventSource.CONNECTING}registerSession(e){return E(this,void 0,void 0,function*(){yield this.eventSource.create(null==e?void 0:e.signal,null==e?void 0:e.openingDeadlineMS)})}send(e,t,n,i){var r;return E(this,void 0,void 0,function*(){let o={};"number"==typeof i?o.ttl=i:(o.ttl=null==i?void 0:i.ttl,o.signal=null==i?void 0:i.signal,o.attempts=null==i?void 0:i.attempts);let s=new URL(F(this.bridgeUrl,this.postPath));s.searchParams.append("client_id",this.sessionId),s.searchParams.append("to",t),s.searchParams.append("ttl",((null==o?void 0:o.ttl)||this.defaultTtl).toString()),s.searchParams.append("topic",n);let a=y.encode(e);yield z(e=>E(this,void 0,void 0,function*(){let t=yield this.post(s,a,e.signal);if(!t.ok)throw new S("Bridge send failed, status ".concat(t.status))}),{attempts:null!==(r=null==o?void 0:o.attempts)&&void 0!==r?r:Number.MAX_SAFE_INTEGER,delayMs:this.defaultResendDelay,signal:null==o?void 0:o.signal})})}pause(){this.eventSource.dispose().catch(e=>J("Bridge pause failed, ".concat(e)))}unPause(){return E(this,void 0,void 0,function*(){yield this.eventSource.recreate(0)})}close(){return E(this,void 0,void 0,function*(){yield this.eventSource.dispose().catch(e=>J("Bridge close failed, ".concat(e)))})}setListener(e){this.listener=e}setErrorsListener(e){this.errorsListener=e}post(e,t,n){return E(this,void 0,void 0,function*(){let i=yield fetch(e,{method:"post",body:t,signal:n});if(!i.ok)throw new S("Bridge send failed, status ".concat(i.status));return i})}errorsHandler(e,t){return E(this,void 0,void 0,function*(){if(this.isConnecting)throw e.close(),new S("Bridge error, failed to connect");if(this.isReady){try{this.errorsListener(t)}catch(e){}return}if(this.isClosed)return e.close(),Y("Bridge reconnecting, ".concat(this.defaultReconnectDelay,"ms delay")),yield this.eventSource.recreate(this.defaultReconnectDelay);throw new S("Bridge error, unknown state")})}messagesHandler(e){return E(this,void 0,void 0,function*(){let t;if(e.data!==this.heartbeatMessage&&(yield this.bridgeGatewayStorage.storeLastEventId(e.lastEventId),!this.isClosed)){try{t=JSON.parse(e.data)}catch(e){throw new S("Bridge message parse failed, message ".concat(e.data))}this.listener(t)}})}constructor(e,t,n,i,r){this.bridgeUrl=t,this.sessionId=n,this.listener=i,this.errorsListener=r,this.ssePath="events",this.postPath="message",this.heartbeatMessage="heartbeat",this.defaultTtl=300,this.defaultReconnectDelay=2e3,this.defaultResendDelay=5e3,this.eventSource=function(e,t){var n=this;let i=null,r=null,o=null,s=null,a=null,l=function(l){for(var c=arguments.length,u=Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];return E(n,void 0,void 0,function*(){if(s=null!=l?l:null,null==a||a.abort(),(a=H(l)).signal.aborted)throw new S("Resource creation was aborted");r=null!=u?u:null;let n=e(a.signal,...u);o=n;let c=yield n;if(o!==n&&c!==i)throw yield t(c),new S("Resource creation was aborted by a new resource creation");return i=c})};return{create:l,current:()=>null!=i?i:null,dispose:()=>E(this,void 0,void 0,function*(){try{let e=i;i=null;let n=o;o=null;try{null==a||a.abort()}catch(e){}yield Promise.allSettled([e?t(e):Promise.resolve(),n?t((yield n)):Promise.resolve()])}catch(e){}}),recreate:e=>E(this,void 0,void 0,function*(){let t=i,n=o,a=r,c=s;if(yield G(e),t===i&&n===o&&a===r&&c===s)return yield l(s,...null!=a?a:[]);throw new S("Resource recreation was aborted by a new resource creation")})}}((e,t)=>E(this,void 0,void 0,function*(){let n={bridgeUrl:this.bridgeUrl,ssePath:this.ssePath,sessionId:this.sessionId,bridgeGatewayStorage:this.bridgeGatewayStorage,errorHandler:this.errorsHandler.bind(this),messageHandler:this.messagesHandler.bind(this),signal:e,openingDeadlineMS:t};return yield function(e){return E(this,void 0,void 0,function*(){return yield function(e,t){let n=null==t?void 0:t.timeout,i=H(null==t?void 0:t.signal);return new Promise((t,r)=>E(this,void 0,void 0,function*(){let o;if(i.signal.aborted){r(new S("Operation aborted"));return}void 0!==n&&(o=setTimeout(()=>{i.abort(),r(new S("Timeout after ".concat(n,"ms")))},n)),i.signal.addEventListener("abort",()=>{clearTimeout(o),r(new S("Operation aborted"))},{once:!0});let s={timeout:n,abort:i.signal};yield e(function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];clearTimeout(o),t(...n)},()=>{clearTimeout(o),r()},s)}))}((t,n,i)=>E(this,void 0,void 0,function*(){var r;let o=H(i.signal).signal;if(o.aborted){n(new S("Bridge connection aborted"));return}let s=new URL(F(e.bridgeUrl,e.ssePath));s.searchParams.append("client_id",e.sessionId);let a=yield e.bridgeGatewayStorage.getLastEventId();if(a&&s.searchParams.append("last_event_id",a),o.aborted){n(new S("Bridge connection aborted"));return}let l=new EventSource(s.toString());l.onerror=i=>E(this,void 0,void 0,function*(){if(o.aborted){l.close(),n(new S("Bridge connection aborted"));return}try{let n=yield e.errorHandler(l,i);n!==l&&l.close(),n&&n!==l&&t(n)}catch(e){l.close(),n(e)}}),l.onopen=()=>{if(o.aborted){l.close(),n(new S("Bridge connection aborted"));return}t(l)},l.onmessage=t=>{if(o.aborted){l.close(),n(new S("Bridge connection aborted"));return}e.messageHandler(t)},null===(r=e.signal)||void 0===r||r.addEventListener("abort",()=>{l.close(),n(new S("Bridge connection aborted"))})}),{timeout:e.openingDeadlineMS,signal:e.signal})})}(n)}),e=>E(this,void 0,void 0,function*(){e.close()})),this.bridgeGatewayStorage=new q(e,t)}}function Q(e){return!("connectEvent"in e)}class X{storeConnection(e){return E(this,void 0,void 0,function*(){if("injected"===e.type)return this.storage.setItem(this.storeKey,JSON.stringify(e));if(!Q(e)){let t={sessionKeyPair:e.session.sessionCrypto.stringifyKeypair(),walletPublicKey:e.session.walletPublicKey,bridgeUrl:e.session.bridgeUrl},n={type:"http",connectEvent:e.connectEvent,session:t,lastWalletEventId:e.lastWalletEventId,nextRpcRequestId:e.nextRpcRequestId};return this.storage.setItem(this.storeKey,JSON.stringify(n))}let t={type:"http",connectionSource:e.connectionSource,sessionCrypto:e.sessionCrypto.stringifyKeypair()};return this.storage.setItem(this.storeKey,JSON.stringify(t))})}removeConnection(){return E(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getConnection(){return E(this,void 0,void 0,function*(){let e=yield this.storage.getItem(this.storeKey);if(!e)return null;let t=JSON.parse(e);if("injected"===t.type)return t;if("connectEvent"in t){let e=new m(t.session.sessionKeyPair);return{type:"http",connectEvent:t.connectEvent,lastWalletEventId:t.lastWalletEventId,nextRpcRequestId:t.nextRpcRequestId,session:{sessionCrypto:e,bridgeUrl:t.session.bridgeUrl,walletPublicKey:t.session.walletPublicKey}}}return{type:"http",sessionCrypto:new m(t.sessionCrypto),connectionSource:t.connectionSource}})}getHttpConnection(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();if(!e)throw new S("Trying to read HTTP connection source while nothing is stored");if("injected"===e.type)throw new S("Trying to read HTTP connection source while injected connection is stored");return e})}getHttpPendingConnection(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();if(!e)throw new S("Trying to read HTTP connection source while nothing is stored");if("injected"===e.type)throw new S("Trying to read HTTP connection source while injected connection is stored");if(!Q(e))throw new S("Trying to read HTTP-pending connection while http connection is stored");return e})}getInjectedConnection(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();if(!e)throw new S("Trying to read Injected bridge connection source while nothing is stored");if((null==e?void 0:e.type)==="http")throw new S("Trying to read Injected bridge connection source while HTTP connection is stored");return e})}storedConnectionType(){return E(this,void 0,void 0,function*(){let e=yield this.storage.getItem(this.storeKey);return e?JSON.parse(e).type:null})}storeLastWalletEventId(e){return E(this,void 0,void 0,function*(){let t=yield this.getConnection();if(t&&"http"===t.type&&!Q(t))return t.lastWalletEventId=e,this.storeConnection(t)})}getLastWalletEventId(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();if(e&&"lastWalletEventId"in e)return e.lastWalletEventId})}increaseNextRpcRequestId(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();if(e&&"nextRpcRequestId"in e){let t=e.nextRpcRequestId||0;return e.nextRpcRequestId=t+1,this.storeConnection(e)}})}getNextRpcRequestId(){return E(this,void 0,void 0,function*(){let e=yield this.getConnection();return e&&"nextRpcRequestId"in e&&e.nextRpcRequestId||0})}constructor(e){this.storage=e,this.storeKey="ton-connect-storage_bridge-connection"}}class Z{static fromStorage(e){return E(this,void 0,void 0,function*(){let t=new X(e),n=yield t.getHttpConnection();return Q(n)?new Z(e,n.connectionSource):new Z(e,{bridgeUrl:n.session.bridgeUrl})})}connect(e,t){var n;let i=H(null==t?void 0:t.signal);null===(n=this.abortController)||void 0===n||n.abort(),this.abortController=i,this.closeGateways();let r=new m;this.session={sessionCrypto:r,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},this.connectionStorage.storeConnection({type:"http",connectionSource:this.walletConnectionSource,sessionCrypto:r}).then(()=>E(this,void 0,void 0,function*(){i.signal.aborted||(yield z(e=>{var n;return this.openGateways(r,{openingDeadlineMS:null!==(n=null==t?void 0:t.openingDeadlineMS)&&void 0!==n?n:this.defaultOpeningDeadlineMS,signal:null==e?void 0:e.signal})},{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:i.signal}))}));let o="universalLink"in this.walletConnectionSource&&this.walletConnectionSource.universalLink?this.walletConnectionSource.universalLink:this.standardUniversalLink;return this.generateUniversalLink(o,e)}restoreConnection(e){var t,n;return E(this,void 0,void 0,function*(){let i=H(null==e?void 0:e.signal);if(null===(t=this.abortController)||void 0===t||t.abort(),this.abortController=i,i.signal.aborted)return;this.closeGateways();let r=yield this.connectionStorage.getHttpConnection();if(!r||i.signal.aborted)return;let o=null!==(n=null==e?void 0:e.openingDeadlineMS)&&void 0!==n?n:this.defaultOpeningDeadlineMS;if(Q(r))return this.session={sessionCrypto:r.sessionCrypto,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},yield this.openGateways(r.sessionCrypto,{openingDeadlineMS:o,signal:null==i?void 0:i.signal});if(Array.isArray(this.walletConnectionSource))throw new S("Internal error. Connection source is array while WalletConnectionSourceHTTP was expected.");if(this.session=r.session,this.gateway&&(Y("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new V(this.storage,this.walletConnectionSource.bridgeUrl,r.session.sessionCrypto.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),!i.signal.aborted){this.listeners.forEach(e=>e(r.connectEvent));try{yield z(e=>this.gateway.registerSession({openingDeadlineMS:o,signal:e.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:i.signal})}catch(e){yield this.disconnect({signal:i.signal});return}}})}sendRequest(e,t){let n={};return"function"==typeof t?n.onRequestSent=t:(n.onRequestSent=null==t?void 0:t.onRequestSent,n.signal=null==t?void 0:t.signal,n.attempts=null==t?void 0:t.attempts),new Promise((t,i)=>E(this,void 0,void 0,function*(){var r;if(!this.gateway||!this.session||!("walletPublicKey"in this.session))throw new S("Trying to send bridge request without session");let o=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),Y("Send http-bridge request:",Object.assign(Object.assign({},e),{id:o}));let s=this.session.sessionCrypto.encrypt(JSON.stringify(Object.assign(Object.assign({},e),{id:o})),b(this.session.walletPublicKey));try{yield this.gateway.send(s,this.session.walletPublicKey,e.method,{attempts:null==n?void 0:n.attempts,signal:null==n?void 0:n.signal}),null===(r=null==n?void 0:n.onRequestSent)||void 0===r||r.call(n),this.pendingRequests.set(o.toString(),t)}catch(e){i(e)}}))}closeConnection(){this.closeGateways(),this.listeners=[],this.session=null,this.gateway=null}disconnect(e){return E(this,void 0,void 0,function*(){return new Promise(t=>E(this,void 0,void 0,function*(){let n=!1,i=null,r=()=>{n||(n=!0,this.removeBridgeAndSession().then(t))};try{this.closeGateways();let t=H(null==e?void 0:e.signal);i=setTimeout(()=>{t.abort()},this.defaultOpeningDeadlineMS),yield this.sendRequest({method:"disconnect",params:[]},{onRequestSent:r,signal:t.signal,attempts:1})}catch(e){Y("Disconnect error:",e),n||this.removeBridgeAndSession().then(t)}finally{i&&clearTimeout(i),r()}}))})}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(t=>t!==e)}pause(){var e;null===(e=this.gateway)||void 0===e||e.pause(),this.pendingGateways.forEach(e=>e.pause())}unPause(){return E(this,void 0,void 0,function*(){let e=this.pendingGateways.map(e=>e.unPause());this.gateway&&e.push(this.gateway.unPause()),yield Promise.all(e)})}pendingGatewaysListener(e,t,n){return E(this,void 0,void 0,function*(){if(!this.pendingGateways.includes(e)){yield e.close();return}return this.closeGateways({except:e}),this.gateway&&(Y("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.session.bridgeUrl=t,this.gateway=e,this.gateway.setErrorsListener(this.gatewayErrorsListener.bind(this)),this.gateway.setListener(this.gatewayListener.bind(this)),this.gatewayListener(n)})}gatewayListener(e){return E(this,void 0,void 0,function*(){let t=JSON.parse(this.session.sessionCrypto.decrypt(y.decode(e.message).toUint8Array(),b(e.from)));if(Y("Wallet message received:",t),!("event"in t)){let e=t.id.toString(),n=this.pendingRequests.get(e);if(!n){Y("Response id ".concat(e," doesn't match any request's id"));return}n(t),this.pendingRequests.delete(e);return}if(void 0!==t.id){let e=yield this.connectionStorage.getLastWalletEventId();if(void 0!==e&&t.id<=e){J("Received event id (=".concat(t.id,") must be greater than stored last wallet event id (=").concat(e,") "));return}"connect"!==t.event&&(yield this.connectionStorage.storeLastWalletEventId(t.id))}let n=this.listeners;"connect"===t.event&&(yield this.updateSession(t,e.from)),"disconnect"===t.event&&(Y("Removing bridge and session: received disconnect event"),yield this.removeBridgeAndSession()),n.forEach(e=>e(t))})}gatewayErrorsListener(e){return E(this,void 0,void 0,function*(){throw new S("Bridge error ".concat(JSON.stringify(e)))})}updateSession(e,t){return E(this,void 0,void 0,function*(){this.session=Object.assign(Object.assign({},this.session),{walletPublicKey:t});let n=e.payload.items.find(e=>"ton_addr"===e.name),i=Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),{items:[n]})});yield this.connectionStorage.storeConnection({type:"http",session:this.session,lastWalletEventId:e.id,connectEvent:i,nextRpcRequestId:0})})}removeBridgeAndSession(){return E(this,void 0,void 0,function*(){this.closeConnection(),yield this.connectionStorage.removeConnection()})}generateUniversalLink(e,t){return!function(e){if(!e)return!1;let t=new URL(e);return"tg:"===t.protocol||"t.me"===t.hostname}(e)?this.generateRegularUniversalLink(e,t):this.generateTGUniversalLink(e,t)}generateRegularUniversalLink(e,t){let n=new URL(e);return n.searchParams.append("v","2"),n.searchParams.append("id",this.session.sessionCrypto.sessionId),n.searchParams.append("r",JSON.stringify(t)),n.toString()}generateTGUniversalLink(e,t){let n="tonconnect-"+this.generateRegularUniversalLink("about:blank",t).split("?")[1].replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--"),i=this.convertToDirectLink(e),r=new URL(i);return r.searchParams.append("startapp",n),r.toString()}convertToDirectLink(e){let t=new URL(e);return t.searchParams.has("attach")&&(t.searchParams.delete("attach"),t.pathname+="/start"),t.toString()}openGateways(e,t){return E(this,void 0,void 0,function*(){if(!Array.isArray(this.walletConnectionSource))return this.gateway&&(Y("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new V(this.storage,this.walletConnectionSource.bridgeUrl,e.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),yield this.gateway.registerSession({openingDeadlineMS:null==t?void 0:t.openingDeadlineMS,signal:null==t?void 0:t.signal});this.pendingGateways.map(e=>e.close().catch()),this.pendingGateways=this.walletConnectionSource.map(t=>{let n=new V(this.storage,t.bridgeUrl,e.sessionId,()=>{},()=>{});return n.setListener(e=>this.pendingGatewaysListener(n,t.bridgeUrl,e)),n}),yield Promise.allSettled(this.pendingGateways.map(e=>z(n=>{var i;return this.pendingGateways.some(t=>t===e)?e.registerSession({openingDeadlineMS:null!==(i=null==t?void 0:t.openingDeadlineMS)&&void 0!==i?i:this.defaultOpeningDeadlineMS,signal:n.signal}):e.close()},{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:null==t?void 0:t.signal})))})}closeGateways(e){var t;null===(t=this.gateway)||void 0===t||t.close(),this.pendingGateways.filter(t=>t!==(null==e?void 0:e.except)).forEach(e=>e.close()),this.pendingGateways=[]}constructor(e,t){this.storage=e,this.walletConnectionSource=t,this.type="http",this.standardUniversalLink="tc://",this.pendingRequests=new Map,this.session=null,this.gateway=null,this.pendingGateways=[],this.listeners=[],this.defaultOpeningDeadlineMS=12e3,this.defaultRetryTimeoutMS=2e3,this.connectionStorage=new X(e)}}function $(e,t){return!!e&&"object"==typeof e&&t.every(t=>t in e)}class ee{static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(e){var t;return null!==(t=this.storage[e])&&void 0!==t?t:null}key(e){var t;let n=Object.keys(this.storage);return e<0||e>=n.length?null:null!==(t=n[e])&&void 0!==t?t:null}removeItem(e){delete this.storage[e]}setItem(e,t){this.storage[e]=t}constructor(){this.storage={}}}function et(){return window}class en{static fromStorage(e){return E(this,void 0,void 0,function*(){let t=new X(e);return new en(e,(yield t.getInjectedConnection()).jsBridgeKey)})}static isWalletInjected(e){return en.isWindowContainsWallet(this.window,e)}static isInsideWalletBrowser(e){return!!en.isWindowContainsWallet(this.window,e)&&this.window[e].tonconnect.isWalletBrowser}static getCurrentlyInjectedWallets(){return this.window?(function(){let e=et();if(!e)return[];try{return Object.keys(e)}catch(e){return[]}})().filter(e=>{let[t,n]=e;return function(e){try{var t;if(!$(e,["tonconnect"])||(t=e.tonconnect,!$(t,["walletInfo"])))return!1;return $(e.tonconnect.walletInfo,["name","app_name","image","about_url","platforms"])}catch(e){return!1}}(n)}).map(e=>{let[t,n]=e;return{name:n.tonconnect.walletInfo.name,appName:n.tonconnect.walletInfo.app_name,aboutUrl:n.tonconnect.walletInfo.about_url,imageUrl:n.tonconnect.walletInfo.image,tondns:n.tonconnect.walletInfo.tondns,jsBridgeKey:t,injected:!0,embedded:n.tonconnect.isWalletBrowser,platforms:n.tonconnect.walletInfo.platforms}}):[]}static isWindowContainsWallet(e,t){return!!e&&t in e&&"object"==typeof e[t]&&"tonconnect"in e[t]}connect(e){this._connect(2,e)}restoreConnection(){return E(this,void 0,void 0,function*(){try{Y("Injected Provider restoring connection...");let e=yield this.injectedWallet.restoreConnection();Y("Injected Provider restoring connection response",e),"connect"===e.event?(this.makeSubscriptions(),this.listeners.forEach(t=>t(e))):yield this.connectionStorage.removeConnection()}catch(e){yield this.connectionStorage.removeConnection()}})}closeConnection(){this.listenSubscriptions&&this.injectedWallet.disconnect(),this.closeAllListeners()}disconnect(){return E(this,void 0,void 0,function*(){return new Promise(e=>{let t=()=>{this.closeAllListeners(),this.connectionStorage.removeConnection().then(e)};try{this.injectedWallet.disconnect(),t()}catch(e){Y(e),this.sendRequest({method:"disconnect",params:[]},t)}})})}closeAllListeners(){var e;this.listenSubscriptions=!1,this.listeners=[],null===(e=this.unsubscribeCallback)||void 0===e||e.call(this)}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(t=>t!==e)}sendRequest(e,t){var n;return E(this,void 0,void 0,function*(){let i={};"function"==typeof t?i.onRequestSent=t:(i.onRequestSent=null==t?void 0:t.onRequestSent,i.signal=null==t?void 0:t.signal);let r=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),Y("Send injected-bridge request:",Object.assign(Object.assign({},e),{id:r}));let o=this.injectedWallet.send(Object.assign(Object.assign({},e),{id:r}));return o.then(e=>Y("Wallet message received:",e)),null===(n=null==i?void 0:i.onRequestSent)||void 0===n||n.call(i),o})}_connect(e,t){return E(this,void 0,void 0,function*(){try{Y("Injected Provider connect request: protocolVersion: ".concat(e,", message:"),t);let n=yield this.injectedWallet.connect(e,t);Y("Injected Provider connect response:",n),"connect"===n.event&&(yield this.updateSession(),this.makeSubscriptions()),this.listeners.forEach(e=>e(n))}catch(t){Y("Injected Provider connect error:",t);let e={event:"connect_error",payload:{code:0,message:null==t?void 0:t.toString()}};this.listeners.forEach(t=>t(e))}})}makeSubscriptions(){this.listenSubscriptions=!0,this.unsubscribeCallback=this.injectedWallet.listen(e=>{Y("Wallet message received:",e),this.listenSubscriptions&&this.listeners.forEach(t=>t(e)),"disconnect"===e.event&&this.disconnect()})}updateSession(){return this.connectionStorage.storeConnection({type:"injected",jsBridgeKey:this.injectedWalletKey,nextRpcRequestId:0})}constructor(e,t){this.injectedWalletKey=t,this.type="injected",this.unsubscribeCallback=null,this.listenSubscriptions=!1,this.listeners=[];let n=en.window;if(!en.isWindowContainsWallet(n,t))throw new j;this.connectionStorage=new X(e),this.injectedWallet=n[t].tonconnect}}en.window=et();class ei{getItem(e){return E(this,void 0,void 0,function*(){return this.localStorage.getItem(e)})}removeItem(e){return E(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}setItem(e,t){return E(this,void 0,void 0,function*(){this.localStorage.setItem(e,t)})}constructor(){this.localStorage=function(){if(function(){try{return"undefined"!=typeof localStorage}catch(e){return!1}}())return localStorage;if(void 0!==_&&null!=_.versions&&null!=_.versions.node)throw new S("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return ee.getInstance()}()}}function er(e){return"jsBridgeKey"in e&&e.injected&&e.embedded}let eo=[{app_name:"telegram-wallet",name:"Wallet",image:"https://wallet.tg/images/logo-288.png",about_url:"https://wallet.tg/",universal_url:"https://t.me/wallet?attach=wallet",bridge:[{type:"sse",url:"https://bridge.ton.space/bridge"}],platforms:["ios","android","macos","windows","linux"]},{app_name:"tonkeeper",name:"Tonkeeper",image:"https://tonkeeper.com/assets/tonconnect-icon.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com",universal_url:"https://app.tonkeeper.com/ton-connect",deepLink:"tonkeeper-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"},{type:"js",key:"tonkeeper"}],platforms:["ios","android","chrome","firefox","macos"]},{app_name:"mytonwallet",name:"MyTonWallet",image:"https://static.mytonwallet.io/icon-256.png",about_url:"https://mytonwallet.io",universal_url:"https://connect.mytonwallet.org",bridge:[{type:"js",key:"mytonwallet"},{type:"sse",url:"https://tonconnectbridge.mytonwallet.org/bridge/"}],platforms:["chrome","windows","macos","linux","ios","android","firefox"]},{app_name:"openmask",name:"OpenMask",image:"https://raw.githubusercontent.com/OpenProduct/openmask-extension/main/public/openmask-logo-288.png",about_url:"https://www.openmask.app/",bridge:[{type:"js",key:"openmask"}],platforms:["chrome"]},{app_name:"tonhub",name:"Tonhub",image:"https://tonhub.com/tonconnect_logo.png",about_url:"https://tonhub.com",universal_url:"https://tonhub.com/ton-connect",bridge:[{type:"js",key:"tonhub"},{type:"sse",url:"https://connect.tonhubapi.com/tonconnect"}],platforms:["ios","android"]},{app_name:"dewallet",name:"DeWallet",image:"https://raw.githubusercontent.com/delab-team/manifests-images/main/WalletAvatar.png",about_url:"https://delabwallet.com",universal_url:"https://t.me/dewallet?attach=wallet",bridge:[{type:"sse",url:"https://sse-bridge.delab.team/bridge"}],platforms:["ios","android"]},{app_name:"xtonwallet",name:"XTONWallet",image:"https://xtonwallet.com/assets/img/icon-256-back.png",about_url:"https://xtonwallet.com",bridge:[{type:"js",key:"xtonwallet"}],platforms:["chrome","firefox"]},{app_name:"tonwallet",name:"TON Wallet",image:"https://wallet.ton.org/assets/ui/qr-logo.png",about_url:"https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd",bridge:[{type:"js",key:"tonwallet"}],platforms:["chrome"]},{app_name:"bitgetTonWallet",name:"Bitget Wallet",image:"https://raw.githubusercontent.com/bitkeepwallet/download/main/logo/png/bitget_wallet_logo_0_gas_fee.png",about_url:"https://web3.bitget.com",deepLink:"bitkeep://",bridge:[{type:"js",key:"bitgetTonWallet"},{type:"sse",url:"https://bridge.tonapi.io/bridge"}],platforms:["ios","android","chrome"],universal_url:"https://bkcode.vip/ton-connect"},{app_name:"safepalwallet",name:"SafePal",image:"https://s.pvcliping.com/web/public_image/SafePal_x288.png",tondns:"",about_url:"https://www.safepal.com",universal_url:"https://link.safepal.io/ton-connect",deepLink:"safepal-tc://",bridge:[{type:"sse",url:"https://ton-bridge.safepal.com/tonbridge/v1/bridge"},{type:"js",key:"safepalwallet"}],platforms:["ios","android","chrome","firefox"]},{app_name:"okxTonWallet",name:"OKX Wallet",image:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",about_url:"https://www.okx.com/web3",universal_url:"https://www.okx.com/download?appendQuery=true&deeplink=okx://web3/wallet/tonconnect",bridge:[{type:"js",key:"okxTonWallet"},{type:"sse",url:"https://www.okx.com/tonbridge/discover/rpc/bridge"}],platforms:["chrome","safari","firefox","ios","android"]},{app_name:"okxTonWalletTr",name:"OKX TR Wallet",image:"https://static.okx.com/cdn/assets/imgs/247/587A8296F0BB640F.png",about_url:"https://tr.okx.com/web3",universal_url:"https://tr.okx.com/download?appendQuery=true&deeplink=okxtr://web3/wallet/tonconnect",bridge:[{type:"js",key:"okxTonWallet"},{type:"sse",url:"https://www.okx.com/tonbridge/discover/rpc/bridge"}],platforms:["chrome","safari","firefox","ios","android"]}];class es{getWallets(){return E(this,void 0,void 0,function*(){return this.cacheTTLMs&&this.walletsListCacheCreationTimestamp&&Date.now()>this.walletsListCacheCreationTimestamp+this.cacheTTLMs&&(this.walletsListCache=null),this.walletsListCache||(this.walletsListCache=this.fetchWalletsList(),this.walletsListCache.then(()=>{this.walletsListCacheCreationTimestamp=Date.now()}).catch(()=>{this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null})),this.walletsListCache})}getEmbeddedWallet(){return E(this,void 0,void 0,function*(){let e=(yield this.getWallets()).filter(er);return 1!==e.length?null:e[0]})}fetchWalletsList(){return E(this,void 0,void 0,function*(){let e=[];try{let t=yield fetch(this.walletsListSource);if(e=yield t.json(),!Array.isArray(e))throw new L("Wrong wallets list format, wallets list must be an array.");let n=e.filter(e=>!this.isCorrectWalletConfigDTO(e));n.length&&(J("Wallet(s) ".concat(n.map(e=>e.name).join(", ")," config format is wrong. They were removed from the wallets list.")),e=e.filter(e=>this.isCorrectWalletConfigDTO(e)))}catch(t){J(t),e=eo}let t=[];try{t=en.getCurrentlyInjectedWallets()}catch(e){J(e)}return this.mergeWalletsLists(this.walletConfigDTOListToWalletConfigList(e),t)})}walletConfigDTOListToWalletConfigList(e){return e.map(e=>{let t={name:e.name,appName:e.app_name,imageUrl:e.image,aboutUrl:e.about_url,tondns:e.tondns,platforms:e.platforms};return e.bridge.forEach(n=>{if("sse"===n.type&&(t.bridgeUrl=n.url,t.universalLink=e.universal_url,t.deepLink=e.deepLink),"js"===n.type){let e=n.key;t.jsBridgeKey=e,t.injected=en.isWalletInjected(e),t.embedded=en.isInsideWalletBrowser(e)}}),t})}mergeWalletsLists(e,t){return[...new Set(e.concat(t).map(e=>e.name)).values()].map(n=>{let i=e.find(e=>e.name===n),r=t.find(e=>e.name===n);return Object.assign(Object.assign({},i&&Object.assign({},i)),r&&Object.assign({},r))})}isCorrectWalletConfigDTO(e){if(!e||"object"!=typeof e||!("name"in e)||!("image"in e)||!("about_url"in e)||!("platforms"in e)||!("app_name"in e)||!e.platforms||!Array.isArray(e.platforms)||!e.platforms.length||!("bridge"in e)||!Array.isArray(e.bridge)||!e.bridge.length)return!1;let t=e.bridge;if(t.some(e=>!e||"object"!=typeof e||!("type"in e)))return!1;let n=t.find(e=>"sse"===e.type);if(n&&(!("url"in n)||!n.url||!e.universal_url))return!1;let i=t.find(e=>"js"===e.type);return!i||"key"in i&&!!i.key}constructor(e){this.walletsListCache=null,this.walletsListCacheCreationTimestamp=null,this.walletsListSource="https://raw.githubusercontent.com/ton-blockchain/wallets-list/main/wallets-v2.json",(null==e?void 0:e.walletsListSource)&&(this.walletsListSource=e.walletsListSource),(null==e?void 0:e.cacheTTLMs)&&(this.cacheTTLMs=e.cacheTTLMs)}}class ea extends S{get info(){return"Wallet doesn't support requested feature method."}constructor(...e){super(...e),Object.setPrototypeOf(this,ea.prototype)}}function el(e){return{ton_connect_sdk_lib:e.ton_connect_sdk_lib,ton_connect_ui_lib:e.ton_connect_ui_lib}}function ec(e,t){var n,i,r,o,s,a,l,c;let u=(null===(n=null==t?void 0:t.connectItems)||void 0===n?void 0:n.tonProof)&&"proof"in t.connectItems.tonProof;return{wallet_address:null!==(r=null===(i=null==t?void 0:t.account)||void 0===i?void 0:i.address)&&void 0!==r?r:null,wallet_type:null!==(o=null==t?void 0:t.device.appName)&&void 0!==o?o:null,wallet_version:null!==(s=null==t?void 0:t.device.appVersion)&&void 0!==s?s:null,auth_type:u?"ton_proof":"ton_addr",custom_data:Object.assign({chain_id:null!==(l=null===(a=null==t?void 0:t.account)||void 0===a?void 0:a.chain)&&void 0!==l?l:null,provider:null!==(c=null==t?void 0:t.provider)&&void 0!==c?c:null},el(e))}}function eu(e,t){var n,i,r,o;return{valid_until:null!==(n=String(t.validUntil))&&void 0!==n?n:null,from:null!==(o=null!==(i=t.from)&&void 0!==i?i:null===(r=null==e?void 0:e.account)||void 0===r?void 0:r.address)&&void 0!==o?o:null,messages:t.messages.map(e=>{var t,n;return{address:null!==(t=e.address)&&void 0!==t?t:null,amount:null!==(n=e.amount)&&void 0!==n?n:null}})}}class ed{dispatchEvent(e,t){var n;return E(this,void 0,void 0,function*(){let i=new CustomEvent(e,{detail:t});null===(n=this.window)||void 0===n||n.dispatchEvent(i)})}addEventListener(e,t,n){var i;return E(this,void 0,void 0,function*(){return null===(i=this.window)||void 0===i||i.addEventListener(e,t,n),()=>{var n;return null===(n=this.window)||void 0===n?void 0:n.removeEventListener(e,t)}})}constructor(){this.window=et()}}class eh{get version(){return el({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}init(){return E(this,void 0,void 0,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectUiVersion=yield this.requestTonConnectUiVersion()}catch(e){}})}setRequestVersionHandler(){return E(this,void 0,void 0,function*(){yield this.eventDispatcher.addEventListener("ton-connect-request-version",()=>E(this,void 0,void 0,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-response-version",{type:"response-version",version:this.tonConnectSdkVersion})}))})}requestTonConnectUiVersion(){return E(this,void 0,void 0,function*(){return new Promise((e,t)=>E(this,void 0,void 0,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-ui-response-version",t=>{e(t.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-ui-request-version",{type:"request-version"})}catch(e){t(e)}}))})}dispatchUserActionEvent(e){try{this.eventDispatcher.dispatchEvent("".concat(this.eventPrefix).concat(e.type),e).catch()}catch(e){}}trackConnectionStarted(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e){return{type:"connection-started",custom_data:el(e)}}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackConnectionCompleted(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t){return Object.assign({type:"connection-completed",is_success:!0},ec(e,t))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackConnectionError(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t,n){return{type:"connection-error",is_success:!1,error_message:t,error_code:null!=n?n:null,custom_data:el(e)}}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackConnectionRestoringStarted(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e){return{type:"connection-restoring-started",custom_data:el(e)}}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackConnectionRestoringCompleted(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t){return Object.assign({type:"connection-restoring-completed",is_success:!0},ec(e,t))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackConnectionRestoringError(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t){return{type:"connection-restoring-error",is_success:!1,error_message:t,custom_data:el(e)}}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackDisconnection(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t,n){return Object.assign({type:"disconnection",scope:n},ec(e,t))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackTransactionSentForSignature(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t,n){return Object.assign(Object.assign({type:"transaction-sent-for-signature"},ec(e,t)),eu(t,n))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackTransactionSigned(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t,n,i){return Object.assign(Object.assign({type:"transaction-signed",is_success:!0,signed_transaction:i.boc},ec(e,t)),eu(t,n))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}trackTransactionSigningFailed(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{let e=function(e,t,n,i,r){return Object.assign(Object.assign({type:"transaction-signing-failed",is_success:!1,error_message:i,error_code:null!=r?r:null},ec(e,t)),eu(t,n))}(this.version,...t);this.dispatchUserActionEvent(e)}catch(e){}}constructor(e){var t;this.eventPrefix="ton-connect-",this.tonConnectUiVersion=null,this.eventDispatcher=null!==(t=null==e?void 0:e.eventDispatcher)&&void 0!==t?t:new ed,this.tonConnectSdkVersion=e.tonConnectSdkVersion,this.init().catch()}}class ef{static getWallets(){return this.walletsList.getWallets()}get connected(){return null!==this._wallet}get account(){var e;return(null===(e=this._wallet)||void 0===e?void 0:e.account)||null}get wallet(){return this._wallet}set wallet(e){this._wallet=e,this.statusChangeSubscriptions.forEach(e=>e(this._wallet))}getWallets(){return this.walletsList.getWallets()}onStatusChange(e,t){return this.statusChangeSubscriptions.push(e),t&&this.statusChangeErrorSubscriptions.push(t),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(t=>t!==e),t&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(e=>e!==t))}}connect(e,t){var n,i;let r={};if("object"==typeof t&&"tonProof"in t&&(r.request=t),"object"==typeof t&&("openingDeadlineMS"in t||"signal"in t||"request"in t)&&(r.request=null==t?void 0:t.request,r.openingDeadlineMS=null==t?void 0:t.openingDeadlineMS,r.signal=null==t?void 0:t.signal),this.connected)throw new k;let o=H(null==r?void 0:r.signal);if(null===(n=this.abortController)||void 0===n||n.abort(),this.abortController=o,o.signal.aborted)throw new S("Connection was aborted");return null===(i=this.provider)||void 0===i||i.closeConnection(),this.provider=this.createProvider(e),o.signal.addEventListener("abort",()=>{var e;null===(e=this.provider)||void 0===e||e.closeConnection(),this.provider=null}),this.tracker.trackConnectionStarted(),this.provider.connect(this.createConnectRequest(null==r?void 0:r.request),{openingDeadlineMS:null==r?void 0:r.openingDeadlineMS,signal:o.signal})}restoreConnection(e){var t,n;return E(this,void 0,void 0,function*(){this.tracker.trackConnectionRestoringStarted();let i=H(null==e?void 0:e.signal);if(null===(t=this.abortController)||void 0===t||t.abort(),this.abortController=i,i.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}let[r,o]=yield Promise.all([this.bridgeConnectionStorage.storedConnectionType(),this.walletsList.getEmbeddedWallet()]);if(i.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}let s=null;try{switch(r){case"http":s=yield Z.fromStorage(this.dappSettings.storage);break;case"injected":s=yield en.fromStorage(this.dappSettings.storage);break;default:if(!o)return;s=this.createProvider(o)}}catch(e){this.tracker.trackConnectionRestoringError("Provider is not restored"),yield this.bridgeConnectionStorage.removeConnection(),null==s||s.closeConnection(),s=null;return}if(i.signal.aborted){null==s||s.closeConnection(),this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}if(!s){J("Provider is not restored"),this.tracker.trackConnectionRestoringError("Provider is not restored");return}null===(n=this.provider)||void 0===n||n.closeConnection(),this.provider=s,s.listen(this.walletEventsListener.bind(this));let a=()=>{this.tracker.trackConnectionRestoringError("Connection restoring was aborted"),null==s||s.closeConnection(),s=null};return i.signal.addEventListener("abort",a),Promise.race([z(t=>E(this,void 0,void 0,function*(){yield null==s?void 0:s.restoreConnection({openingDeadlineMS:null==e?void 0:e.openingDeadlineMS,signal:t.signal}),i.signal.removeEventListener("abort",a),this.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):this.tracker.trackConnectionRestoringError("Connection restoring failed")}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:2e3,signal:null==e?void 0:e.signal}),new Promise(e=>setTimeout(()=>e(),12e3))])})}sendTransaction(e,t){return E(this,void 0,void 0,function*(){let n={};"function"==typeof t?n.onRequestSent=t:(n.onRequestSent=null==t?void 0:t.onRequestSent,n.signal=null==t?void 0:t.signal);let i=H(null==n?void 0:n.signal);if(i.signal.aborted)throw new S("Transaction sending was aborted");this.checkConnection(),function(e,t){let n=e.includes("SendTransaction"),i=e.find(e=>e&&"object"==typeof e&&"SendTransaction"===e.name);if(!n&&!i)throw new ea("Wallet doesn't support SendTransaction feature.");if(i&&void 0!==i.maxMessages){if(i.maxMessages<t.requiredMessagesNumber)throw new ea("Wallet is not able to handle such SendTransaction request. Max support messages number is ".concat(i.maxMessages,", but ").concat(t.requiredMessagesNumber," is required."));return}!function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n]}("Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.")}(this.wallet.device.features,{requiredMessagesNumber:e.messages.length}),this.tracker.trackTransactionSentForSignature(this.wallet,e);let{validUntil:r}=e,o=/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}(e,["validUntil"]),s=e.from||this.account.address,a=e.network||this.account.chain,l=yield this.provider.sendRequest(B.convertToRpcRequest(Object.assign(Object.assign({},o),{valid_until:r,from:s,network:a})),{onRequestSent:n.onRequestSent,signal:i.signal});if(B.isError(l))return this.tracker.trackTransactionSigningFailed(this.wallet,e,l.error.message,l.error.code),B.parseAndThrowError(l);let c=B.convertFromRpcResponse(l);return this.tracker.trackTransactionSigned(this.wallet,e,c),c})}disconnect(e){var t;return E(this,void 0,void 0,function*(){if(!this.connected)throw new T;let n=H(null==e?void 0:e.signal),i=this.abortController;if(this.abortController=n,n.signal.aborted)throw new S("Disconnect was aborted");this.onWalletDisconnected("dapp"),yield null===(t=this.provider)||void 0===t?void 0:t.disconnect({signal:n.signal}),null==i||i.abort()})}pauseConnection(){var e;(null===(e=this.provider)||void 0===e?void 0:e.type)==="http"&&this.provider.pause()}unPauseConnection(){var e;return(null===(e=this.provider)||void 0===e?void 0:e.type)!=="http"?Promise.resolve():this.provider.unPause()}addWindowFocusAndBlurSubscriptions(){let e=function(){if("undefined"!=typeof document)return document}();if(e)try{e.addEventListener("visibilitychange",()=>{e.hidden?this.pauseConnection():this.unPauseConnection().catch()})}catch(e){J("Cannot subscribe to the document.visibilitychange: ",e)}}createProvider(e){let t;return(t=!Array.isArray(e)&&"jsBridgeKey"in e?new en(this.dappSettings.storage,e.jsBridgeKey):new Z(this.dappSettings.storage,e)).listen(this.walletEventsListener.bind(this)),t}walletEventsListener(e){switch(e.event){case"connect":this.onWalletConnected(e.payload);break;case"connect_error":this.onWalletConnectError(e.payload);break;case"disconnect":this.onWalletDisconnected("wallet")}}onWalletConnected(e){let t=e.items.find(e=>"ton_addr"===e.name),n=e.items.find(e=>"ton_proof"===e.name);if(!t)throw new S("ton_addr connection item was not found");let i={device:e.device,provider:this.provider.type,account:{address:t.address,chain:t.network,walletStateInit:t.walletStateInit,publicKey:t.publicKey}};n&&(i.connectItems={tonProof:n}),this.wallet=i,this.tracker.trackConnectionCompleted(i)}onWalletConnectError(e){let t=M.parseError(e);if(this.statusChangeErrorSubscriptions.forEach(e=>e(t)),Y(t),this.tracker.trackConnectionError(e.message,e.code),t instanceof C||t instanceof O)throw J(t),t}onWalletDisconnected(e){this.tracker.trackDisconnection(this.wallet,e),this.wallet=null}checkConnection(){if(!this.connected)throw new T}createConnectRequest(e){let t=[{name:"ton_addr"}];return(null==e?void 0:e.tonProof)&&t.push({name:"ton_proof",payload:e.tonProof}),{manifestUrl:this.dappSettings.manifestUrl,items:t}}constructor(e){if(this.walletsList=new es,this._wallet=null,this.provider=null,this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.dappSettings={manifestUrl:(null==e?void 0:e.manifestUrl)||function(){var e;let t=null===(e=et())||void 0===e?void 0:e.location.origin;return t?t+"/tonconnect-manifest.json":""}(),storage:(null==e?void 0:e.storage)||new ei},this.walletsList=new es({walletsListSource:null==e?void 0:e.walletsListSource,cacheTTLMs:null==e?void 0:e.walletsListCacheTTLMs}),this.tracker=new eh({eventDispatcher:null==e?void 0:e.eventDispatcher,tonConnectSdkVersion:"3.0.5"}),!this.dappSettings.manifestUrl)throw new R("Dapp tonconnect-manifest.json must be specified if window.location.origin is undefined. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest");this.bridgeConnectionStorage=new X(this.dappSettings.storage),(null==e?void 0:e.disableAutoPauseConnection)||this.addWindowFocusAndBlurSubscriptions()}}ef.walletsList=new es,ef.isWalletInjected=e=>en.isWalletInjected(e),ef.isInsideWalletBrowser=e=>en.isInsideWalletBrowser(e);let eg={};for(let e=0;e<=255;e++){let t=e.toString(16);t.length<2&&(t="0"+t),eg[t]=e}}}]);